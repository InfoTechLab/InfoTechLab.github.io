void function(t){var e={},i={};t.startModule=function(t){require(t).start()},t.define=function(t,i){e[t]=i},t.require=function(t){return/\.js$/.test(t)||(t+=".js"),i[t]?i[t]:i[t]=e[t]({})}}(this),define("scripts/collide.js",function(t){function n(t){return t*t}function s(t){return 0>t?-1:t>0?1:0}function o(t,e,i){if(0!=t){var r=e*e-4*t*i;return 0==r?[-1*e/(2*t),-1*e/(2*t)]:r>0?[(-1*e+Math.sqrt(r))/(2*t),(-1*e-Math.sqrt(r))/(2*t)]:void 0}}function u(t,e,i,r,u){if(!(0>=r)){u=void 0===u?1:u;var l,c=r,h=r*u;if(a=n(h)*n(t[0]-e[0])+n(c)*n(t[1]-e[1]),!(0>=a)&&(b=2*n(h)*(e[0]-t[0])*(t[0]-i[0])+2*n(c)*(e[1]-t[1])*(t[1]-i[1]),i=n(h)*n(t[0]-i[0])+n(c)*n(t[1]-i[1])-n(c)*n(h),l=o(a,b,i,c,h))){var f=[[t[0]+l[0]*(e[0]-t[0]),t[1]+l[0]*(e[1]-t[1])],[t[0]+l[1]*(e[0]-t[0]),t[1]+l[1]*(e[1]-t[1])]];return s(f[0][0]-t[0])*s(f[0][0]-e[0])<=0&&s(f[0][1]-t[1])*s(f[0][1]-e[1])<=0||(f[0]=null),s(f[1][0]-t[0])*s(f[1][0]-e[0])<=0&&s(f[1][1]-t[1])*s(f[1][1]-e[1])<=0||(f[1]=null),f}}}function c(t,e,i,r,n){var s=u(t,e,i,r,n);return s&&(s[0]||s[1])}var e=require("scripts/factory/fruit"),r=(require("scripts/lib/ucren"),e.getFruitInView());return t.check=function(t){var e=[],i=0;return r.forEach(function(r){var n=c(t.slice(0,2),t.slice(2,4),[r.originX,r.originY],r.radius);n&&(e[i++]=r)}),e},t}),define("scripts/control.js",function(t){var s,a,e=require("scripts/lib/ucren"),i=require("scripts/object/knife"),r=require("scripts/message"),n=require("scripts/state");return s=a=0,t.init=function(){this.fixCanvasPos(),this.installDragger(),this.installClicker()},t.installDragger=function(){var t=new e.BasicDrag({type:"calc"});t.on("returnValue",function(t,e,n,o,u){(u=i.through(n-s,o-a))&&r.postMessage(u,"slice")}),t.on("startDrag",function(){i.newKnife()}),t.bind(document.documentElement)},t.installClicker=function(){e.addEvent(document,"click",function(){n("click-enable").ison()&&r.postMessage("click")})},t.fixCanvasPos=function(){var t=document.documentElement,i=function(){s=(t.clientWidth-640)/2,a=(t.clientHeight-480)/2-40};i(),e.addEvent(window,"resize",i)},t}),define("scripts/game.js",function(t){var y,b,x,e=require("scripts/timeline"),i=require("scripts/lib/ucren"),r=require("scripts/lib/sound"),n=require("scripts/factory/fruit"),s=require("scripts/object/score"),a=require("scripts/message"),o=require("scripts/state"),u=require("scripts/object/lose"),c=require("scripts/object/game-over"),h=require("scripts/object/knife"),l=require("scripts/object/background"),f=require("scripts/object/light"),p=0,d=i.randomNumber,m=2,v=5,g=[],w=function(){if(!(g.length>=m)){var t=d(640),e=d(640),i=600,r=n.create(t,i).shotOut(0,e);g.push(r),b.play(),w()}};t.start=function(){b=r.create("sound/throw"),x=r.create("sound/boom"),e.setTimeout(function(){o("game-state").set("playing"),y=e.setInterval(w,1e3)},500)},t.gameOver=function(){o("game-state").set("over"),y.stop(),c.show(),p=0,m=2,g.length=0},t.applyScore=function(t){t>m*v&&(m++,v+=50)},t.sliceAt=function(t,e){var i;o("game-state").isnot("playing")||("boom"!=t.type?(t.broken(e),(i=g.indexOf(t))&&g.splice(i,1),s.number(++p),this.applyScore(p)):(x.play(),this.pauseAllFruit(),l.wobble(),f.start(t)))},t.pauseAllFruit=function(){y.stop(),h.pause(),g.invoke("pause")},a.addEventListener("fruit.remove",function(t){var e;(e=g.indexOf(t))>-1&&g.splice(e,1)});var k=function(t){"boom"!=t.type&&u.showLoseAt(t.originX)};return o("game-state").hook(function(t){"playing"==t?a.addEventListener("fruit.fallOutOfViewer",k):a.removeEventListener("fruit.fallOutOfViewer",k)}),a.addEventListener("game.over",function(){t.gameOver(),h.switchOn()}),a.addEventListener("overWhiteLight.show",function(){h.endAll();for(var t=g.length-1;t>=0;t--)g[t].remove();l.stop()}),a.addEventListener("click",function(){o("click-enable").off(),c.hide(),a.postMessage("home-menu","sence.switchSence")}),t}),define("scripts/layer.js",function(t){function s(){return s.num=++s.num||2}var e=require("scripts/lib/raphael"),i=require("scripts/lib/ucren"),r={},n={"default":s(),light:s(),knife:s(),fruit:s(),juice:s(),flash:s(),mask:s()};return t.createImage=function(t,e,i,r,n,s){return t=this.getLayer(t),t.image(e,i,r,n,s)},t.createText=function(t,e,r,n,s,a){return t=this.getLayer(t),i.isIe&&(n+=2),t.text(r,n,e).attr({fill:s||"#fff","font-size":a||"14px","font-family":"黑体","text-anchor":"start"})},t.getLayer=function(t){var s,a;return t=t||"default",(s=r[t])?s:(a=i.makeElement("div",{"class":"layer",style:"z-index: "+(n[t]||0)+";"}),i.Element("extra").add(a),s=r[t]=e(a,640,480))},t}),define("scripts/main.js",function(t){var e=require("scripts/timeline"),i=require("scripts/tools"),r=require("scripts/sence"),n=require("scripts/lib/ucren"),s=require("scripts/lib/buzz"),a=require("scripts/control"),o=require("scripts/object/console"),u=require("scripts/message"),c=require("scripts/state"),h=require("scripts/game"),l=require("scripts/collide"),f=e.setTimeout.bind(e),p=function(){var i,t=1e3,e=300;return i=function(i){f(function(){o.log(i)},t),t+=e},i.clear=function(){f(o.clear.bind(o),t),t+=e},i}();t.start=function(){[e,r,a].invoke("init"),p("正在加载鼠标控制脚本"),p("正在加载图像资源"),p("正在加载游戏脚本"),p("正在加载剧情"),p("正在初始化"),p("正在启动游戏..."),p.clear(),f(r.switchSence.saturate(r,"home-menu"),3e3)},u.addEventListener("slice",function(t){var r,e=l.check(t);e.length&&(r=i.getAngleByRadian(i.pointToRadian(t.slice(0,2),t.slice(2,4))),e.forEach(function(t){u.postMessage(t,r,"slice.at")}))}),u.addEventListener("slice.at",function(t,e){if(!c("sence-state").isnot("ready")){if(c("sence-name").is("game-body"))return void h.sliceAt(t,e);if(c("sence-name").is("home-menu")){if(t.broken(e),t.isHomeMenu)switch(1){case t.isDojoIcon:r.switchSence("dojo-body");break;case t.isNewGameIcon:r.switchSence("game-body");break;case t.isQuitIcon:r.switchSence("quit-body")}}else;}});var d="";return n.isChrome||(d="$为了获得最佳流畅度，推荐您使用 <span class='b'>Google Chrome</span> 体验本游戏"),s.isSupported()||(d=d.replace("$","您的浏览器不支持 &lt;audio&gt 播放声效，且")),d=d.replace("$",""),n.Element("browser").html(d),t}),define("scripts/message.js",function(t){var e=require("scripts/lib/ucren");return t.postMessage=function(t,i){var r=[].slice.call(arguments,0),n=r.length-1;i=r[n],r.slice(0,n),e.dispatch(i,r)},t.addEventListener=function(t,i){e.dispatch(t,i)},t.removeEventListener=function(t,i){e.dispatch.remove(t,i)},t}),define("scripts/sence.js",function(t){{var g,y,b,M,A,i=(require("scripts/lib/ucren"),require("scripts/lib/sound")),r=require("scripts/factory/fruit"),n=require("scripts/object/flash"),s=require("scripts/state"),a=require("scripts/message"),o=require("scripts/object/background"),c=(require("scripts/object/fps"),require("scripts/object/home-mask")),h=require("scripts/object/logo"),l=require("scripts/object/ninja"),f=require("scripts/object/home-desc"),p=require("scripts/object/dojo"),d=require("scripts/object/new-game"),m=require("scripts/object/quit"),v=require("scripts/object/new"),x=require("scripts/object/score"),w=require("scripts/object/lose"),k=require("scripts/game"),T=require("scripts/object/developing"),E=require("scripts/object/game-over"),a=require("scripts/message"),S=require("scripts/timeline"),q=S.setTimeout.bind(S);S.setInterval.bind(S)}return t.init=function(){M=i.create("sound/menu"),A=i.create("sound/start"),[o,c,h,l,f,p,v,d,m,x,w,T,E,n].invoke("set")},t.switchSence=function(e){var i=s("sence-name"),r=s("sence-state");if(!i.is(e)){var n=function(){switch(i.set(e),r.set("entering"),e){case"home-menu":this.showMenu(a);break;case"dojo-body":this.showDojo(a);break;case"game-body":this.showNewGame(a);break;case"quit-body":this.showQuit(a)}}.bind(this),a=function(){r.set("ready"),("dojo-body"==e||"quit-body"==e)&&t.switchSence("home-menu")};r.set("exiting"),i.isunset()?n():i.is("home-menu")?this.hideMenu(n):i.is("dojo-body")?this.hideDojo(n):i.is("game-body")?this.hideNewGame(n):i.is("quit-body")&&this.hideQuit(n)}},t.showMenu=function(t){{var e=arguments.callee;e.times=++e.times||1}g=r.create("peach",137,333,!0),y=r.create("sandia",330,322,!0),b=r.create("boom",552,367,!0,2500),[g,y,b].forEach(function(t){t.isHomeMenu=1}),g.isDojoIcon=y.isNewGameIcon=b.isQuitIcon=1;var n=[[c,0],[h,0],[l,500],[f,1500],[p,2e3],[d,2e3],[m,2e3],[v,2e3],[g,2e3],[y,2e3],[b,2e3]];n.invoke("show"),[g,y].invoke("rotate",2500),M.play(),q(t,2500)},t.hideMenu=function(t){[v,p,d,m].invoke("hide"),[c,h,l,f].invoke("hide"),[g,y,b].invoke("fallOff",150),M.stop(),q(t,r.getDropTimeSetting())},t.showNewGame=function(t){x.show(),w.show(),k.start(),A.play(),q(t,1e3)},t.hideNewGame=function(t){x.hide(),w.hide(),A.stop(),q(t,1e3)},t.showDojo=function(t){T.show(250),q(t,1500)},t.hideDojo=function(t){q(t,1e3)},t.showQuit=function(t){T.show(250),q(t,1500)},t.hideQuit=function(t){q(t,1e3)},a.addEventListener("sence.switchSence",function(e){t.switchSence(e)}),t}),define("scripts/state.js",function(t){var i=(require("scripts/lib/ucren"),require("scripts/timeline")),r={},n={},s={};return t=function(t){return n[t]?n[t]:n[t]={is:function(e){return r[t]===e},isnot:function(e){return r[t]!==e},ison:function(){return this.is(!0)},isoff:function(){return this.isnot(!0)},isunset:function(){return this.is(void 0)},set:function(){var e=0/0;return function(i){var n;if(r[t]=i,e!==i&&(n=s[t]))for(var a=0,o=n.length;o>a;a++)n[a].call(this,i);e=i}}(),get:function(){return r[t]},on:function(){var t=this;return t.set(!0),{keep:function(e){i.setTimeout(t.set.saturate(t,!1),e)}}},off:function(){var t=this;return t.set(!1),{keep:function(e){i.setTimeout(t.set.saturate(t,!0),e)}}},hook:function(e){var i;(i=s[t])?i.push(e):s[t]=[e]},unhook:function(){}}}}),define("scripts/timeline.js",function(t){function n(){this.tasks=[],this.addingTasks=[],this.adding=0}var e=require("scripts/lib/ucren"),i={},r={};n.prototype.init=function(t){var e=this;if(!e.inited)return e.inited=1,e.startTime=s(),e.intervalTime=t||5,e.count=0,e.intervalFn=function(){e.count++,e.update(s())},e.start(),e},n.prototype.createTask=function(t){var e=a(t);return this.addingTasks.unshift(e),this.adding=1,t.recycle&&this.taskList(t.recycle,e),this.start(),e},n.prototype.taskList=function(t,e){return t.clear||(t.clear=function(){for(var t=this.length;t--;)e=this[t],e.stop(),this.splice(t,1);return this}),e&&t.unshift(e),t},n.prototype.setTimeout=function(t,e){return this.createTask({start:e,duration:0,onTimeStart:t})},n.prototype.setInterval=function(t,e){var i=setInterval(t,e);return{stop:function(){clearInterval(i)}}},n.prototype.getFPS=function(){var t=s(),e=this.count,i=e/(t-this.startTime)*1e3;return e>1e3&&(this.count=0,this.startTime=t),i},n.prototype.start=function(){clearInterval(this.interval),this.interval=setInterval(this.intervalFn,this.intervalTime)},n.prototype.stop=function(){clearInterval(this.interval)},n.prototype.update=function(t){for(var s,a,c,h,e=this.tasks,i=this.addingTasks,r=this.adding,n=e.length;n--;)if(a=e[n],c=a.start,h=a.duration,t>=c){if(a.stopped){e.splice(n,1);continue}u(a),(s=t-c)<h?o(a,s):(o(a,h),a.onTimeEnd.apply(a.object,a.data.slice(1)),e.splice(n,1))}r&&(e.unshift.apply(e,i),i.length=r=0),e.length||this.stop()},r.use=function(t){var e;return(e=i[t])?e:e=i[t]=new n};var s=function(){return(new Date).getTime()},a=function(t){var i=t.object||{};return t.start=t.start||0,{start:t.start+s(),duration:-1==t.duration?864e5:t.duration,data:t.data?[0].concat(t.data):[0],started:0,object:i,onTimeStart:t.onTimeStart||i.onTimeStart||e.nul,onTimeUpdate:t.onTimeUpdate||i.onTimeUpdate||e.nul,onTimeEnd:t.onTimeEnd||i.onTimeEnd||e.nul,stop:function(){this.stopped=1}}},o=function(t,e){var i=t.data;i[0]=e,t.onTimeUpdate.apply(t.object,i)},u=function(t){t.started||(t.started=1,t.onTimeStart.apply(t.object,t.data.slice(1)),o(t,0))};return t=r.use("default").init(10),t.use=function(i){return e.isIe,r.use(i)},t}),define("scripts/tools.js",function(t){return t.unsetObject=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=function(){})},t.getAngleByRadian=function(t){return 180*t/Math.PI},t.pointToRadian=function(t,e){var i=Math.PI;if(e[0]===t[0])return e[1]>t[1]?.5*i:1.5*i;if(e[1]===t[1])return e[0]>t[0]?0:i;var r=Math.atan((t[1]-e[1])/(t[0]-e[0]));return e[0]>t[0]&&e[1]<t[1]?r+2*i:e[0]>t[0]&&e[1]>t[1]?r:r+i},t}),define("scripts/factory/displacement.js",function(t){{var e=require("scripts/layer"),i=require("scripts/timeline");require("scripts/lib/tween")}return t.create=function(t,r,n,s,a,o,u,c,h){var f,l={},p={};"function"==typeof c?p.show=p.hide=c:p=c;var d=function(t,e,r,n,s,a,o,u){i.createTask({start:t,duration:e,object:l,data:[r,n,s,a,o,u],onTimeUpdate:l.onTimeUpdate,onTimeStart:l.onTimeStart,onTimeEnd:l.onTimeEnd,recycle:l.anims})};return l.anims=[],l.set=function(){f=e.createImage("default",t,s,a,r,n)},l.show=function(t){d(t,h,s,a,o,u,p.show,"show")},l.hide=function(){this.anims.clear(),d(0,h,o,u,s,a,p.hide,"hide")},l.onTimeUpdate=function(t,e,i,r,n,s){f.attr({x:s(t,e,r-e,h),y:s(t,i,n-i,h)})},l.onTimeStart=function(){},l.onTimeEnd=function(t,e,i,r,n){"hide"===n&&f.hide()},l},t}),define("scripts/factory/fruit.js",function(t){function j(t){var e=T[t.type],i=e[3];this.type=t.type,this.originX=t.originX,this.originY=t.originY,this.radius=i,this.startX=t.originX,this.startY=t.originY,this.radius=i,this.anims=[],"boom"===this.type&&(this.flame=o.create(this.startX-i+4,this.startY-i+5,t.flameStart||0))}function M(){return 4==g(8)?"boom":E[g(5)]}var e=require("scripts/layer"),i=require("scripts/lib/ucren"),r=require("scripts/timeline").use("fruit").init(1),n=require("scripts/timeline").use("fruit-apart").init(1),s=require("scripts/lib/tween"),a=require("scripts/message"),o=require("scripts/object/flame"),u=require("scripts/object/flash"),c=require("scripts/factory/juice"),f=(i.isIe,i.isSafari,s.exponential.co),d=(s.circular,s.linear),m=s.quadratic.ci,v=s.quadratic.co,g=i.randomNumber,y=Math.min,b=function(t,e){return(t+e)/2>>0},x=1200,w=200,k=50,T={boom:["images/fruit/boom.png",66,68,26,0,0,null],peach:["images/fruit/peach.png",62,59,37,-50,0,"#e6c731"],sandia:["images/fruit/sandia.png",98,85,38,-100,0,"#c00"],apple:["images/fruit/apple.png",66,66,31,-54,0,"#c8e925"],banana:["images/fruit/banana.png",126,50,43,90,0,null],basaha:["images/fruit/basaha.png",68,72,32,-135,0,"#c00"]},E=["peach","sandia","apple","banana","basaha"],S=[60,50,40,-40,-50,-60],q=[];return j.prototype.set=function(t){var i=T[this.type],r=this.radius;return this.shadow=e.createImage("fruit","images/shadow.png",this.startX-r,this.startY-r+k,106,77),this.image=e.createImage("fruit",i[0],this.startX-r,this.startY-r,i[1],i[2]),t&&(this.image.hide(),this.shadow.hide()),this},j.prototype.pos=function(t,e){if(t!=this.originX||e!=this.originY){var i=this.radius;this.originX=t,this.originY=e,this.image.attr({x:t-=i,y:e-=i}),this.shadow.attr({x:t,y:e+k}),"boom"===this.type&&this.flame.pos(t+4,e+5)}},j.prototype.show=function(t){r.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onScaling,onTimeStart:this.onShowStart,recycle:this.anims})},j.prototype.hide=function(t){"boom"===this.type&&(this.anims.clear(),this.flame.remove(),r.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd,recycle:this.anims}))},j.prototype.rotate=function(t,e){this.rotateSpeed=e||S[g(6)],this.rotateAnim=r.createTask({start:t,duration:-1,object:this,onTimeUpdate:this.onRotating,recycle:this.anims})},j.prototype.broken=function(t){if(!this.brokend){this.brokend=!0;var e;(e=q.indexOf(this))>-1&&q.splice(e,1),"boom"!==this.type?(u.showAt(this.originX,this.originY,t),c.create(this.originX,this.originY,T[this.type][6]),this.apart(t)):this.hide()}},j.prototype.pause=function(){this.brokend||(this.anims.clear(),"boom"==this.type&&this.flame.remove())},j.prototype.apart=function(t){this.anims.clear(),this.image.hide(),this.shadow.hide(),this.aparted=!0;var i=T[this.type],r=i[0].replace(".png",""),s=this.radius,a=e.createImage.saturate(e,this.startX-s,this.startY-s,i[1],i[2]);t=(t%180+360+i[4])%360,this.bImage1=a("fruit",r+"-1.png"),this.bImage2=a("fruit",r+"-2.png"),[this.bImage1,this.bImage2].invoke("rotate",t),this.apartAngle=t,n.createTask({start:0,duration:x,object:this,onTimeUpdate:this.onBrokenDropUpdate,onTimeStart:this.onBrokenDropStart,onTimeEnd:this.onBrokenDropEnd,recycle:this.anims})},j.prototype.shotOut=function(){var t=[-1,1];return function(e,i){return this.shotOutStartX=this.originX,this.shotOutStartY=this.originY,this.shotOutEndX=b(this.originX,i),this.shotOutEndY=y(this.startY-g(this.startY-100),200),this.fallOffToX=i,r.createTask({start:e,duration:x,object:this,onTimeUpdate:this.onShotOuting,onTimeStart:this.onShotOutStart,onTimeEnd:this.onShotOutEnd,recycle:this.anims}),"boom"!=this.type&&this.rotate(0,(g(180)+90)*t[g(2)]),this}}(),j.prototype.fallOff=function(){var t=[-1,1],e=0;return function(i,n){if(!this.aparted&&!this.brokend){var s=600;"number"!=typeof n&&(n=this.originX+g(w)*t[e++%2]),this.fallTargetX=n,this.fallTargetY=s,r.createTask({start:i,duration:x,object:this,onTimeUpdate:this.onFalling,onTimeStart:this.onFallStart,onTimeEnd:this.onFallEnd,recycle:this.anims})}}}(),j.prototype.remove=function(){var t;this.anims.clear(),this.image&&(this.image.remove(),this.shadow.remove()),this.bImage1&&(this.bImage1.remove(),this.bImage2.remove()),"boom"===this.type&&this.flame.remove(),(t=q.indexOf(this))>-1&&q.splice(t,1);for(var e in this)"function"==typeof this[e]?this[e]=function(t){return function(){throw new Error("method "+t+" has been removed")}}(e):delete this[e];a.postMessage(this,"fruit.remove")},j.prototype.onShowStart=function(){this.image.show()},j.prototype.onScaling=function(t,e,i,r){this.image.scale(r=f(t,e,i-e,500),r),this.shadow.scale(r,r)},j.prototype.onHideEnd=function(){this.remove()},j.prototype.onRotateStart=function(){},j.prototype.onRotating=function(t){this.image.rotate(this.rotateSpeed*t/1e3%360,!0)},j.prototype.onBrokenDropUpdate=function(t){var e=this.radius;this.bImage1.attr({x:d(t,this.brokenPosX-e,this.brokenTargetX1,x),y:m(t,this.brokenPosY-e,this.brokenTargetY1-this.brokenPosY+e,x)}).rotate(d(t,this.apartAngle,this.bImage1RotateAngle,x),!0),this.bImage2.attr({x:d(t,this.brokenPosX-e,this.brokenTargetX2,x),y:m(t,this.brokenPosY-e,this.brokenTargetY2-this.brokenPosY+e,x)}).rotate(d(t,this.apartAngle,this.bImage2RotateAngle,x),!0)},j.prototype.onBrokenDropStart=function(){this.brokenTargetX1=-(g(w)+75),this.brokenTargetX2=g(w+75),this.brokenTargetY1=600,this.brokenTargetY2=600,this.brokenPosX=this.originX,this.brokenPosY=this.originY,this.bImage1RotateAngle=-g(150)-50,this.bImage2RotateAngle=g(150)+50;for(var e=q.length-1;e>=0;e--)q[e]===this&&q.splice(e,1)},j.prototype.onBrokenDropEnd=function(){this.remove()},j.prototype.onShotOuting=function(t){this.pos(d(t,this.shotOutStartX,this.shotOutEndX-this.shotOutStartX,x),v(t,this.shotOutStartY,this.shotOutEndY-this.shotOutStartY,x))},j.prototype.onShotOutStart=function(){},j.prototype.onShotOutEnd=function(){this.fallOff(0,this.fallOffToX)},j.prototype.onFalling=function(t){var e;this.pos(d(t,this.brokenPosX,this.fallTargetX-this.brokenPosX,x),e=m(t,this.brokenPosY,this.fallTargetY-this.brokenPosY,x)),this.checkForFallOutOfViewer(e)},j.prototype.onFallStart=function(){this.brokenPosX=this.originX,this.brokenPosY=this.originY},j.prototype.onFallEnd=function(){a.postMessage(this,"fruit.fallOff"),this.remove()},j.prototype.checkForFallOutOfViewer=function(t){t>480+this.radius&&(this.checkForFallOutOfViewer=i.nul,this.rotateAnim&&this.rotateAnim.stop(),a.postMessage(this,"fruit.fallOutOfViewer"))},t.create=function(t,e,i,r,n){"number"==typeof t&&(r=i,i=e,e=t,t=M());var s=new j({type:t,originX:e,originY:i,flameStart:n}).set(r);return q.unshift(s),s},t.getFruitInView=function(){return q},t.getDropTimeSetting=function(){return x},t}),define("scripts/factory/juice.js",function(t){function d(t,e,i){this.originX=t,this.originY=e,this.color=i,this.distance=a(200)+100,this.radius=p,this.dir=a(360)*Math.PI/180}var e=require("scripts/lib/ucren"),i=require("scripts/layer").getLayer("juice"),r=require("scripts/timeline").use("juice").init(10),n=require("scripts/lib/tween"),s=require("scripts/tools"),a=e.randomNumber,o=1500,u=n.exponential.co,c=n.quadratic.co,h=Math.sin,l=Math.cos,f=10,p=10;return d.prototype.render=function(){this.circle=i.circle(this.originX,this.originY,this.radius).attr({fill:this.color,stroke:"none"})},d.prototype.sputter=function(){r.createTask({start:0,duration:o,object:this,onTimeUpdate:this.onTimeUpdate,onTimeEnd:this.onTimeEnd})},d.prototype.onTimeUpdate=function(t){var e,i,r,n;e=u(t,0,this.distance,o),i=this.originX+e*l(this.dir),r=this.originY+e*h(this.dir)+c(t,0,200,o),n=u(t,1,-1,o),this.circle.attr({cx:i,cy:r}).scale(n,n)},d.prototype.onTimeEnd=function(){this.circle.remove(),s.unsetObject(this)},t.create=function(t,e,i){for(var r=0;f>r;r++)this.createOne(t,e,i)},t.createOne=function(t,e,i){if(i){var r=new d(t,e,i);r.render(),r.sputter()}},t}),define("scripts/factory/rotate.js",function(t){var e=require("scripts/layer"),i=require("scripts/timeline"),r=require("scripts/lib/ucren");return t.create=function(t,n,s,a,o,u,c,h){var f,l={},p=[12,-12][r.randomNumber(2)],d=r.randomNumber(360);return l.anims=[],l.set=function(){f=e.createImage("default",t,n,s,a,o).scale(u,u).rotate(d,!0)},l.show=function(t){i.createTask({start:t,duration:h,object:this,data:[u,1],onTimeUpdate:this.onZooming,onTimeEnd:this.onShowEnd,recycle:this.anims})},l.hide=function(t){this.anims.clear(),i.createTask({start:t,duration:h,object:this,data:[1,u],onTimeUpdate:this.onZooming,recycle:this.anims})},l.onShowEnd=function(){this.anims.clear(),i.createTask({start:0,duration:-1,object:this,onTimeUpdate:l.onRotating,recycle:this.anims})},l.onZooming=function(){var t;return function(e,i,r){f.scale(t=c(e,i,r-i,h),t)}}(),l.onRotating=function(){var t=0,e=d;return function(i){e=(e+(i-t)/1e3*p)%360,f.rotate(e,!0),t=i}}(),l},t}),define("scripts/lib/buzz.js",function(t){var e={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,i){function o(t){for(var e=[],i=t.length-1,r=0;i>=r;r++)e.push({start:t.start(i),end:t.end(i)});return e}function u(t){return t.split(".").pop()}function c(t,i){var r=document.createElement("source");r.src=i,e.types[u(i)]&&(r.type=e.types[u(i)]),t.appendChild(r)}i=i||{};var r=0,n=[],s={},a=e.isSupported();if(this.load=function(){return a?(this.sound.load(),this):this},this.play=function(){return a?(this.sound.play(),this):this},this.togglePlay=function(){return a?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return a?(this.sound.pause(),this):this},this.isPaused=function(){return a?this.sound.paused:null},this.stop=function(){return a?(this.setTime(this.getDuration()),this.sound.pause(),this):this},this.isEnded=function(){return a?this.sound.ended:null},this.loop=function(){return a?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return a?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return a?(this.sound.muted=!0,this):this},this.unmute=function(){return a?(this.sound.muted=!1,this):this},this.toggleMute=function(){return a?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return a?this.sound.muted:null},this.setVolume=function(t){return a?(0>t&&(t=0),t>100&&(t=100),this.volume=t,this.sound.volume=t/100,this):this},this.getVolume=function(){return a?this.volume:this},this.increaseVolume=function(t){return this.setVolume(this.volume+(t||1))},this.decreaseVolume=function(t){return this.setVolume(this.volume-(t||1))},this.setTime=function(t){return a?(this.whenReady(function(){this.sound.currentTime=t}),this):this},this.getTime=function(){if(!a)return null;var t=Math.round(100*this.sound.currentTime)/100;return isNaN(t)?e.defaults.placeholder:t},this.setPercent=function(t){return a?this.setTime(e.fromPercent(t,this.sound.duration)):this},this.getPercent=function(){if(!a)return null;var t=Math.round(e.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(t)?e.defaults.placeholder:t},this.setSpeed=function(t){return a?void(this.sound.playbackRate=t):this},this.getSpeed=function(){return a?this.sound.playbackRate:null},this.getDuration=function(){if(!a)return null;var t=Math.round(100*this.sound.duration)/100;return isNaN(t)?e.defaults.placeholder:t},this.getPlayed=function(){return a?o(this.sound.played):null},this.getBuffered=function(){return a?o(this.sound.buffered):null},this.getSeekable=function(){return a?o(this.sound.seekable):null},this.getErrorCode=function(){return a&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!a)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return a?this.sound.readyState:null},this.getStateMessage=function(){if(!a)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return a?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!a)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(t,e){return a?(this.sound[t]=e,this):this},this.get=function(t){return a?t?this.sound[t]:this.sound:null},this.bind=function(t,e){if(!a)return this;t=t.split(" ");for(var i=this,r=function(t){e.call(i,t)},s=0;s<t.length;s++){var o=t[s],u=o;o=u.split(".")[0],n.push({idx:u,func:r}),this.sound.addEventListener(o,r,!0)}return this},this.unbind=function(t){if(!a)return this;t=t.split(" ");for(var e=0;e<t.length;e++)for(var i=t[e],r=i.split(".")[0],s=0;s<n.length;s++){var o=n[s].idx.split(".");(n[s].idx==i||o[1]&&o[1]==i.replace(".",""))&&(this.sound.removeEventListener(r,n[s].func,!0),n.splice(s,1))}return this},this.bindOnce=function(t,e){if(!a)return this;var i=this;s[r++]=!1,this.bind(r+t,function(){s[r]||(s[r]=!0,e.call(i)),i.unbind(r+t)})},this.trigger=function(t){if(!a)return this;t=t.split(" ");for(var e=0;e<t.length;e++)for(var i=t[e],r=0;r<n.length;r++){var s=n[r].idx.split(".");if(n[r].idx==i||s[0]&&s[0]==i.replace(".","")){var o=document.createEvent("HTMLEvents");o.initEvent(s[0],!1,!0),this.sound.dispatchEvent(o)}}return this},this.fadeTo=function(t,i,r){function u(){setTimeout(function(){t>n&&o.volume<t?(o.setVolume(o.volume+=1),u()):n>t&&o.volume>t?(o.setVolume(o.volume-=1),u()):r instanceof Function&&r.apply(o)},s)}if(!a)return this;i instanceof Function?(r=i,i=e.defaults.duration):i=i||e.defaults.duration;var n=this.volume,s=i/Math.abs(n-t),o=this;return this.play(),this.whenReady(function(){u()}),this},this.fadeIn=function(t,e){return a?this.setVolume(0).fadeTo(100,t,e):this},this.fadeOut=function(t,e){return a?this.fadeTo(0,t,e):this},this.fadeWith=function(t,e){return a?(this.fadeOut(e,function(){this.stop()}),t.play().fadeIn(e),this):this},this.whenReady=function(t){if(!a)return null;var e=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){t.call(e)}):t.call(e)},a&&t){for(var h in e.defaults)e.defaults.hasOwnProperty(h)&&(i[h]=i[h]||e.defaults[h]);if(this.sound=document.createElement("audio"),t instanceof Array)for(var l in t)t.hasOwnProperty(l)&&c(this.sound,t[l]);else if(i.formats.length)for(var f in i.formats)i.formats.hasOwnProperty(f)&&c(this.sound,t+"."+i.formats[f]);else c(this.sound,t);i.loop&&this.loop(),i.autoplay&&(this.sound.autoplay="autoplay"),this.sound.preload=i.preload===!0?"auto":i.preload===!1?"none":i.preload,this.setVolume(i.volume),e.sounds.push(this)}},group:function(t){function e(){for(var e=i(null,arguments),r=e.shift(),n=0;n<t.length;n++)t[n][r].apply(t[n],e)}function i(t,e){return t instanceof Array?t:Array.prototype.slice.call(e)}t=i(t,arguments),this.getSounds=function(){return t},this.add=function(e){e=i(e,arguments);for(var r=0;r<e.length;r++)t.push(e[r])},this.remove=function(e){e=i(e,arguments);for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(t[n]==e[r]){delete t[n];break}},this.load=function(){return e("load"),this},this.play=function(){return e("play"),this},this.togglePlay=function(){return e("togglePlay"),this},this.pause=function(t){return e("pause",t),this},this.stop=function(){return e("stop"),this},this.mute=function(){return e("mute"),this},this.unmute=function(){return e("unmute"),this},this.toggleMute=function(){return e("toggleMute"),this},this.setVolume=function(t){return e("setVolume",t),this},this.increaseVolume=function(t){return e("increaseVolume",t),this},this.decreaseVolume=function(t){return e("decreaseVolume",t),this},this.loop=function(){return e("loop"),this},this.unloop=function(){return e("unloop"),this},this.setTime=function(t){return e("setTime",t),this},this.setduration=function(t){return e("setduration",t),this},this.set=function(t,i){return e("set",t,i),this},this.bind=function(t,i){return e("bind",t,i),this},this.unbind=function(t){return e("unbind",t),this},this.bindOnce=function(t,i){return e("bindOnce",t,i),this},this.trigger=function(t){return e("trigger",t),this},this.fade=function(t,i,r,n){return e("fade",t,i,r,n),this},this.fadeIn=function(t,i){return e("fadeIn",t,i),this},this.fadeOut=function(t,i){return e("fadeOut",t,i),this}},all:function(){return new e.group(e.sounds)},isSupported:function(){return!!e.el.canPlayType},isOGGSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!e.el.canPlayType&&e.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!e.el.canPlayType&&(e.el.canPlayType("audio/x-m4a;")||e.el.canPlayType("audio/aac;"))},toTimer:function(t,e){var i,r,n;return i=Math.floor(t/3600),i=isNaN(i)?"--":i>=10?i:"0"+i,r=Math.floor(e?t/60%60:t/60),r=isNaN(r)?"--":r>=10?r:"0"+r,n=Math.floor(t%60),n=isNaN(n)?"--":n>=10?n:"0"+n,e?i+":"+r+":"+n:r+":"+n},fromTimer:function(t){var e=t.toString().split(":");return e&&3==e.length&&(t=3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseInt(e[2],10)),e&&2==e.length&&(t=60*parseInt(e[0],10)+parseInt(e[1],10)),t},toPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(100*t/e*r)/r},fromPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(e/100*t*r)/r}};return t=e}),define("scripts/lib/raphael.js",function(t){var e,i={};return function(){function t(){if(t.is(arguments[0],O)){for(var e=arguments[0],i=Ze[d](t,e.splice(0,3+t.is(e[0],U))),r=i.set(),s=0,a=e[E];a>s;s++){var u=e[s]||{};n[o](u.type)&&r[R](i[u.type]().attr(u))}return r}return Ze[d](t,arguments)}function ce(){for(var t=[],e=0;32>e;e++)t[e]=(~~(16*q.random()))[_](16);return t[12]=4,t[16]=(3&t[16]|8)[_](16),"r-"+t[T]("")}function de(t,e,i){function r(){var n=Array[a].slice.call(arguments,0),s=n[T]("►"),u=r.cache=r.cache||{},c=r.count=r.count||[];return u[o](s)?i?i(u[s]):u[s]:(c[E]>=1e3&&delete u[c.shift()],c[R](s),u[s]=t[d](e,n),i?i(u[s]):u[s])}return r}function si(e,i,r,n,s){return s?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+s,i,r-2*s,s,-s,n-2*s,2*s-r,2*s-n):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,i,r,n,-r)}function gi(){return this.x+y+this.y}function Ai(e){return function(i,r,n,s){var a={back:e};return t.is(n,"function")?s=n:a.rot=n,i&&i.constructor==Xe&&(i=i.attrs.path),i&&(a.along=i),this.animate(a,r,s)}}function Ni(t,e,i,r,n,s){function f(t){return((u*t+o)*t+a)*t
}function p(t,e){var i=d(t,e);return((l*i+h)*i+c)*i}function d(t,e){var i,r,n,s,c,h;for(n=t,h=0;8>h;h++){if(s=f(n)-t,A(s)<e)return n;if(c=(3*u*n+2*o)*n+a,A(c)<1e-6)break;n-=s/c}if(i=0,r=1,n=t,i>n)return i;if(n>r)return r;for(;r>i;){if(s=f(n),A(s-t)<e)return n;t>s?i=n:r=n,n=(r-i)/2+i}return n}var a=3*e,o=3*(r-e)-a,u=1-a-o,c=3*i,h=3*(n-i)-c,l=1-c-h;return p(t,1/(200*s))}t.version="1.5.2";var f,r=/[, ]+/,n={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},s=/\{(\d+)\}/g,a="prototype",o="hasOwnProperty",u=document,c=i,h={was:Object[a][o].call(c,"Raphael"),is:c.Raphael},l=function(){this.customAttributes={}},p="appendChild",d="apply",m="concat",v="createTouch"in u,g="",y=" ",b=String,x="split",w="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[x](y),k={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},T="join",E="length",S=b[a].toLowerCase,q=Math,j=q.max,M=q.min,A=q.abs,N=q.pow,I=q.PI,U="number",C="string",O="array",_="toString",B="fill",L=Object[a][_],R="push",D=/^url\(['"]?([^\)]+?)['"]?\)$/i,X=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,Y={NaN:1,Infinity:1,"-Infinity":1},V=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,H=q.round,z="setAttribute",G=parseFloat,F=parseInt,W=" progid:DXImageTransform.Microsoft",Z=b[a].toUpperCase,$={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Q={along:"along",blur:U,"clip-rect":"csv",cx:U,cy:U,fill:"colour","fill-opacity":U,"font-size":U,height:U,opacity:U,path:"path",r:U,rotation:"csv",rx:U,ry:U,scale:"csv",stroke:"colour","stroke-opacity":U,"stroke-width":U,translation:"csv",width:U,x:U,y:U},K="replace",J=/^(from|to|\d+%?)$/,te=/\s*,\s*/,ee={hs:1,rg:1},ie=/,?([achlmqrstvxz]),?/gi,re=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,ne=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,se=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,ae=function(t,e){return t.key-e.key};if(t.type=c.SVGAngle||u.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ue,oe=u.createElement("div");if(oe.innerHTML='<v:shape adj="1"/>',ue=oe.firstChild,ue.style.behavior="url(#default#VML)",!ue||"object"!=typeof ue.adj)return t.type=null;oe=null}t.svg=!(t.vml="VML"==t.type),l[a]=t[a],f=l[a],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=S.call(e),"finite"==e?!Y[o](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||L.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,i,r,n,s,a){if(null==s){var o=e-r,u=i-n;return o||u?(180*(0>o)+180*q.atan(-u/-o)/I+360)%360:0}return t.angle(e,i,s,a)-t.angle(r,n,s,a)},t.rad=function(t){return t%360*I/180},t.deg=function(t){return 180*t/I%360},t.snapTo=function(e,i,r){if(r=t.is(r,"finite")?r:10,t.is(e,O)){for(var n=e.length;n--;)if(A(e[n]-i)<=r)return e[n]}else{e=+e;var s=i%e;if(r>s)return i-s;if(s>e-r)return i-s+e}return i},t.setWindow=function(t){c=t,u=c.document};var he=function(t){if(n.vml){var i,e=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),i=r.body}catch(n){i=createPopup().document.body}var s=i.createTextRange();he=de(function(t){try{i.style.color=b(t)[K](e,g);var r=s.queryCommandValue("ForeColor");return r=(255&r)<<16|65280&r|(16711680&r)>>>16,"#"+("000000"+r[_](16)).slice(-6)}catch(t){return"none"}})}else{var a=u.createElement("i");a.title="Raphaël Colour Picker",a.style.display="none",u.body[p](a),he=de(function(t){return a.style.color=t,u.defaultView.getComputedStyle(a,g).getPropertyValue("color")})}return he(t)},le=function(){return"hsb("+[this.h,this.s,this.b]+")"},fe=function(){return"hsl("+[this.h,this.s,this.l]+")"},pe=function(){return this.hex};t.hsb2rgb=function(e,i,r,n){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(r=e.b,i=e.s,e=e.h,n=e.o),t.hsl2rgb(e,i,r/2,n)},t.hsl2rgb=function(e,i,r,n){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(r=e.l,i=e.s,e=e.h),(e>1||i>1||r>1)&&(e/=360,i/=100,r/=100);var o,u,c,s={},a=["r","g","b"];if(i){o=.5>r?r*(1+i):r+i-r*i,u=2*r-o;for(var p=0;3>p;p++)c=e+1/3*-(p-1),0>c&&c++,c>1&&c--,s[a[p]]=1>6*c?u+6*(o-u)*c:1>2*c?o:2>3*c?u+(o-u)*(2/3-c)*6:u}else s={r:r,g:r,b:r};return s.r*=255,s.g*=255,s.b*=255,s.hex="#"+(16777216|s.b|s.g<<8|s.r<<16).toString(16).slice(1),t.is(n,"finite")&&(s.opacity=n),s.toString=pe,s},t.rgb2hsb=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,C)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var o,u,s=j(e,i,r),a=M(e,i,r),c=s;if(a==s)return{h:0,s:0,b:s,toString:le};var h=s-a;return u=h/s,o=e==s?(i-r)/h:i==s?2+(r-e)/h:4+(e-i)/h,o/=6,0>o&&o++,o>1&&o--,{h:o,s:u,b:c,toString:le}},t.rgb2hsl=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,C)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var o,u,h,s=j(e,i,r),a=M(e,i,r),c=(s+a)/2;if(a==s)h={h:0,s:0,l:c};else{var l=s-a;u=.5>c?l/(s+a):l/(2-s-a),o=e==s?(i-r)/l:i==s?2+(r-e)/l:4+(e-i)/l,o/=6,0>o&&o++,o>1&&o--,h={h:o,s:u,l:c}}return h.toString=fe,h},t._path2string=function(){return this.join(",")[K](ie,"$1")},t.getRGB=de(function(e){if(!e||(e=b(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(ee[o](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=he(e));var r,n,s,a,u,c,h=e.match(X);return h?(h[2]&&(s=F(h[2].substring(5),16),n=F(h[2].substring(3,5),16),r=F(h[2].substring(1,3),16)),h[3]&&(s=F((u=h[3].charAt(3))+u,16),n=F((u=h[3].charAt(2))+u,16),r=F((u=h[3].charAt(1))+u,16)),h[4]&&(c=h[4][x](te),r=G(c[0]),"%"==c[0].slice(-1)&&(r*=2.55),n=G(c[1]),"%"==c[1].slice(-1)&&(n*=2.55),s=G(c[2]),"%"==c[2].slice(-1)&&(s*=2.55),"rgba"==h[1].toLowerCase().slice(0,4)&&(a=G(c[3])),c[3]&&"%"==c[3].slice(-1)&&(a/=100)),h[5]?(c=h[5][x](te),r=G(c[0]),"%"==c[0].slice(-1)&&(r*=2.55),n=G(c[1]),"%"==c[1].slice(-1)&&(n*=2.55),s=G(c[2]),"%"==c[2].slice(-1)&&(s*=2.55),("deg"==c[0].slice(-3)||"°"==c[0].slice(-1))&&(r/=360),"hsba"==h[1].toLowerCase().slice(0,4)&&(a=G(c[3])),c[3]&&"%"==c[3].slice(-1)&&(a/=100),t.hsb2rgb(r,n,s,a)):h[6]?(c=h[6][x](te),r=G(c[0]),"%"==c[0].slice(-1)&&(r*=2.55),n=G(c[1]),"%"==c[1].slice(-1)&&(n*=2.55),s=G(c[2]),"%"==c[2].slice(-1)&&(s*=2.55),("deg"==c[0].slice(-3)||"°"==c[0].slice(-1))&&(r/=360),"hsla"==h[1].toLowerCase().slice(0,4)&&(a=G(c[3])),c[3]&&"%"==c[3].slice(-1)&&(a/=100),t.hsl2rgb(r,n,s,a)):(h={r:r,g:n,b:s},h.hex="#"+(16777216|s|n<<8|r<<16).toString(16).slice(1),t.is(a,"finite")&&(h.opacity=a),h)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=de(function(e){if(!e)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return t.is(e,O)&&t.is(e[0],O)&&(r=ve(e)),r[E]||b(e)[K](re,function(t,e,n){var s=[],a=S.call(e);for(n[K](ne,function(t,e){e&&s[R](+e)}),"m"==a&&s[E]>2&&(r[R]([e][m](s.splice(0,2))),a="l",e="m"==e?"l":"L");s[E]>=i[a]&&(r[R]([e][m](s.splice(0,i[a]))),i[a]););}),r[_]=t._path2string,r}),t.findDotsAtSegment=function(t,e,i,r,n,s,a,o,u){var c=1-u,h=N(c,3)*t+3*N(c,2)*u*i+3*c*u*u*n+N(u,3)*a,l=N(c,3)*e+3*N(c,2)*u*r+3*c*u*u*s+N(u,3)*o,f=t+2*u*(i-t)+u*u*(n-2*i+t),p=e+2*u*(r-e)+u*u*(s-2*r+e),d=i+2*u*(n-i)+u*u*(a-2*n+i),m=r+2*u*(s-r)+u*u*(o-2*s+r),v=(1-u)*t+u*i,g=(1-u)*e+u*r,y=(1-u)*n+u*a,b=(1-u)*s+u*o,x=90-180*q.atan((f-d)/(p-m))/I;return(f>d||m>p)&&(x+=180),{x:h,y:l,m:{x:f,y:p},n:{x:d,y:m},start:{x:v,y:g},end:{x:y,y:b},alpha:x}};var me=de(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=Ee(t);for(var s,e=0,i=0,r=[],n=[],a=0,o=t[E];o>a;a++)if(s=t[a],"M"==s[0])e=s[1],i=s[2],r[R](e),n[R](i);else{var u=Te(e,i,s[1],s[2],s[3],s[4],s[5],s[6]);r=r[m](u.min.x,u.max.x),n=n[m](u.min.y,u.max.y),e=s[5],i=s[6]}var c=M[d](0,r),h=M[d](0,n);return{x:c,y:h,width:j[d](0,r)-c,height:j[d](0,n)-h}}),ve=function(e){var i=[];t.is(e,O)&&t.is(e&&e[0],O)||(e=t.parsePathString(e));for(var r=0,n=e[E];n>r;r++){i[r]=[];for(var s=0,a=e[r][E];a>s;s++)i[r][s]=e[r][s]}return i[_]=t._path2string,i},ge=de(function(e){t.is(e,O)&&t.is(e&&e[0],O)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,a=0,o=0;"M"==e[0][0]&&(r=e[0][1],n=e[0][2],s=r,a=n,o++,i[R](["M",r,n]));for(var u=o,c=e[E];c>u;u++){var h=i[u]=[],l=e[u];if(l[0]!=S.call(l[0]))switch(h[0]=S.call(l[0]),h[0]){case"a":h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=+(l[6]-r).toFixed(3),h[7]=+(l[7]-n).toFixed(3);break;case"v":h[1]=+(l[1]-n).toFixed(3);break;case"m":s=l[1],a=l[2];default:for(var f=1,p=l[E];p>f;f++)h[f]=+(l[f]-(f%2?r:n)).toFixed(3)}else{h=i[u]=[],"m"==l[0]&&(s=l[1]+r,a=l[2]+n);for(var d=0,m=l[E];m>d;d++)i[u][d]=l[d]}var v=i[u][E];switch(i[u][0]){case"z":r=s,n=a;break;case"h":r+=+i[u][v-1];break;case"v":n+=+i[u][v-1];break;default:r+=+i[u][v-2],n+=+i[u][v-1]}}return i[_]=t._path2string,i},0,ve),ye=de(function(e){t.is(e,O)&&t.is(e&&e[0],O)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,a=0,o=0;"M"==e[0][0]&&(r=+e[0][1],n=+e[0][2],s=r,a=n,o++,i[0]=["M",r,n]);for(var u=o,c=e[E];c>u;u++){var h=i[u]=[],l=e[u];if(l[0]!=Z.call(l[0]))switch(h[0]=Z.call(l[0]),h[0]){case"A":h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=+(l[6]+r),h[7]=+(l[7]+n);break;case"V":h[1]=+l[1]+n;break;case"H":h[1]=+l[1]+r;break;case"M":s=+l[1]+r,a=+l[2]+n;default:for(var f=1,p=l[E];p>f;f++)h[f]=+l[f]+(f%2?r:n)}else for(var d=0,m=l[E];m>d;d++)i[u][d]=l[d];switch(h[0]){case"Z":r=s,n=a;break;case"H":r=h[1];break;case"V":n=h[1];break;case"M":s=i[u][i[u][E]-2],a=i[u][i[u][E]-1];default:r=i[u][i[u][E]-2],n=i[u][i[u][E]-1]}}return i[_]=t._path2string,i},null,ve),be=function(t,e,i,r){return[t,e,i,r,i,r]},xe=function(t,e,i,r,n,s){var a=1/3,o=2/3;return[a*t+o*i,a*e+o*r,a*n+o*i,a*s+o*r,n,s]},we=function(t,e,i,r,n,s,a,o,u,c){var p,h=120*I/180,l=I/180*(+n||0),f=[],d=de(function(t,e,i){var r=t*q.cos(i)-e*q.sin(i),n=t*q.sin(i)+e*q.cos(i);return{x:r,y:n}});if(c)U=c[0],C=c[1],M=c[2],N=c[3];else{p=d(t,e,-l),t=p.x,e=p.y,p=d(o,u,-l),o=p.x,u=p.y;var y=(q.cos(I/180*n),q.sin(I/180*n),(t-o)/2),b=(e-u)/2,w=y*y/(i*i)+b*b/(r*r);w>1&&(w=q.sqrt(w),i=w*i,r=w*r);var k=i*i,S=r*r,j=(s==a?-1:1)*q.sqrt(A((k*S-k*b*b-S*y*y)/(k*b*b+S*y*y))),M=j*i*b/r+(t+o)/2,N=j*-r*y/i+(e+u)/2,U=q.asin(((e-N)/r).toFixed(9)),C=q.asin(((u-N)/r).toFixed(9));U=M>t?I-U:U,C=M>o?I-C:C,0>U&&(U=2*I+U),0>C&&(C=2*I+C),a&&U>C&&(U-=2*I),!a&&C>U&&(C-=2*I)}var O=C-U;if(A(O)>h){var _=C,B=o,L=u;C=U+h*(a&&C>U?1:-1),o=M+i*q.cos(C),u=N+r*q.sin(C),f=we(o,u,i,r,n,0,a,B,L,[C,_,M,N])}O=C-U;var P=q.cos(U),R=q.sin(U),D=q.cos(C),X=q.sin(C),Y=q.tan(O/4),V=4/3*i*Y,H=4/3*r*Y,z=[t,e],G=[t+V*R,e-H*P],F=[o+V*X,u-H*D],W=[o,u];if(G[0]=2*z[0]-G[0],G[1]=2*z[1]-G[1],c)return[G,F,W][m](f);f=[G,F,W][m](f)[T]()[x](",");for(var Z=[],$=0,Q=f[E];Q>$;$++)Z[$]=$%2?d(f[$-1],f[$],l).y:d(f[$],f[$+1],l).x;return Z},ke=function(t,e,i,r,n,s,a,o,u){var c=1-u;return{x:N(c,3)*t+3*N(c,2)*u*i+3*c*u*u*n+N(u,3)*a,y:N(c,3)*e+3*N(c,2)*u*r+3*c*u*u*s+N(u,3)*o}},Te=de(function(t,e,i,r,n,s,a,o){var v,u=n-2*i+t-(a-2*n+i),c=2*(i-t)-2*(n-i),h=t-i,l=(-c+q.sqrt(c*c-4*u*h))/2/u,f=(-c-q.sqrt(c*c-4*u*h))/2/u,p=[e,o],m=[t,a];return A(l)>"1e12"&&(l=.5),A(f)>"1e12"&&(f=.5),l>0&&1>l&&(v=ke(t,e,i,r,n,s,a,o,l),m[R](v.x),p[R](v.y)),f>0&&1>f&&(v=ke(t,e,i,r,n,s,a,o,f),m[R](v.x),p[R](v.y)),u=s-2*r+e-(o-2*s+r),c=2*(r-e)-2*(s-r),h=e-r,l=(-c+q.sqrt(c*c-4*u*h))/2/u,f=(-c-q.sqrt(c*c-4*u*h))/2/u,A(l)>"1e12"&&(l=.5),A(f)>"1e12"&&(f=.5),l>0&&1>l&&(v=ke(t,e,i,r,n,s,a,o,l),m[R](v.x),p[R](v.y)),f>0&&1>f&&(v=ke(t,e,i,r,n,s,a,o,f),m[R](v.x),p[R](v.y)),{min:{x:M[d](0,m),y:M[d](0,p)},max:{x:j[d](0,m),y:j[d](0,p)}}}),Ee=de(function(t,e){for(var i=ye(t),r=e&&ye(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][m](we[d](0,[e.x,e.y][m](t.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),r=e.y+(e.y-(e.by||e.y)),t=["C",i,r][m](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][m](xe(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][m](xe(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][m](be(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][m](be(e.x,e.y,t[1],e.y));break;case"V":t=["C"][m](be(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][m](be(e.x,e.y,e.X,e.Y))}return t}),o=function(t,e){if(t[e][E]>7){t[e].shift();for(var n=t[e];n[E];)t.splice(e++,0,["C"][m](n.splice(0,6)));t.splice(e,1),h=j(i[E],r&&r[E]||0)}},u=function(t,e,n,s,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],h=j(i[E],r&&r[E]||0))},c=0,h=j(i[E],r&&r[E]||0);h>c;c++){i[c]=a(i[c],n),o(i,c),r&&(r[c]=a(r[c],s)),r&&o(r,c),u(i,r,n,s,c),u(r,i,s,n,c);var l=i[c],f=r&&r[c],p=l[E],v=r&&f[E];n.x=l[p-2],n.y=l[p-1],n.bx=G(l[p-4])||n.x,n.by=G(l[p-3])||n.y,s.bx=r&&(G(f[v-4])||s.x),s.by=r&&(G(f[v-3])||s.y),s.x=r&&f[v-2],s.y=r&&f[v-1]}return r?[i,r]:i},null,ve),Se=de(function(e){for(var i=[],r=0,n=e[E];n>r;r++){var s={},a=e[r].match(/^([^:]*):?([\d\.]*)/);if(s.color=t.getRGB(a[1]),s.color.error)return null;s.color=s.color.hex,a[2]&&(s.offset=a[2]+"%"),i[R](s)}for(r=1,n=i[E]-1;n>r;r++)if(!i[r].offset){for(var o=G(i[r-1].offset||0),u=0,c=r+1;n>c;c++)if(i[c].offset){u=i[c].offset;break}u||(u=100,c=n),u=G(u);for(var h=(u-o)/(c-r+1);c>r;r++)o+=h,i[r].offset=o+"%"}return i}),qe=function(e,i,r,n){var s;return t.is(e,C)||t.is(e,"object")?(s=t.is(e,C)?u.getElementById(e):e,s.tagName?null==i?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:i,height:r}:void 0):{container:1,x:e,y:i,width:r,height:n}},je=function(t,e){var i=this;for(var r in e)if(e[o](r)&&!(r in t))switch(typeof e[r]){case"function":!function(e){t[r]=t===i?e:function(){return e[d](i,arguments)}}(e[r]);break;case"object":t[r]=t[r]||{},je.call(this,t[r],e[r]);break;default:t[r]=e[r]}},Me=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},Ae=function(t,e){e.top!==t&&(Me(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},Ne=function(t,e){e.bottom!==t&&(Me(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},Ie=function(t,e,i){Me(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},Ue=function(t,e,i){Me(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},Ce=function(t){return function(){throw new Error("Raphaël: you are calling to method “"+t+"” of removed object")}};if(t.pathToRelative=ge,t.svg){f.svgns="http://www.w3.org/2000/svg",f.xlink="http://www.w3.org/1999/xlink",H=function(t){return+t+.5*(~~t===t)};var Oe=function(t,e){if(!e)return t=u.createElementNS(f.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in e)e[o](i)&&t[z](i,b(e[i]))};t[_]=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var _e=function(t,e){var i=Oe("path");e.canvas&&e.canvas[p](i);var r=new Xe(i,e);return r.type="path",Pe(r,{fill:"none",stroke:"#000",path:t}),r},Be=function(t,e,i){var r="linear",n=.5,s=.5,a=t.style;if(e=b(e)[K](se,function(t,e,i){if(r="radial",e&&i){n=G(e),s=G(i);var a=2*(s>.5)-1;N(n-.5,2)+N(s-.5,2)>.25&&(s=q.sqrt(.25-N(n-.5,2))*a+.5)&&.5!=s&&(s=s.toFixed(5)-1e-5*a)}return g}),e=e[x](/\s*\-\s*/),"linear"==r){var o=e.shift();if(o=-G(o),isNaN(o))return null;var c=[0,0,q.cos(o*I/180),q.sin(o*I/180)],h=1/(j(A(c[2]),A(c[3]))||1);c[2]*=h,c[3]*=h,c[2]<0&&(c[0]=-c[2],c[2]=0),c[3]<0&&(c[1]=-c[3],c[3]=0)}var l=Se(e);if(!l)return null;var f=t.getAttribute(B);f=f.match(/^url\(#(.*)\)$/),f&&i.defs.removeChild(u.getElementById(f[1]));var d=Oe(r+"Gradient");d.id=ce(),Oe(d,"radial"==r?{fx:n,fy:s}:{x1:c[0],y1:c[1],x2:c[2],y2:c[3]}),i.defs[p](d);for(var m=0,v=l[E];v>m;m++){var y=Oe("stop");Oe(y,{offset:l[m].offset?l[m].offset:m?"100%":"0%","stop-color":l[m].color||"#fff"}),d[p](y)}return Oe(t,{fill:"url(#"+d.id+")",opacity:1,"fill-opacity":1}),a.fill=g,a.opacity=1,a.fillOpacity=1,1},Le=function(e){var i=e.getBBox();Oe(e.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Pe=function(e,i){var n={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},s=e.node,a=e.attrs,c=e.rotate(),h=function(t,e){if(e=n[S.call(e)]){for(var r=t.attrs["stroke-width"]||"1",a={round:r,square:r,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,o=[],u=e[E];u--;)o[u]=e[u]*r+(u%2?1:-1)*a;Oe(s,{"stroke-dasharray":o[T](",")})}};i[o]("rotation")&&(c=i.rotation);var l=b(c)[x](r);l.length-1?(l[1]=+l[1],l[2]=+l[2]):l=null,G(c)&&e.rotate(0,!0);for(var f in i)if(i[o](f)){if(!$[o](f))continue;var d=i[f];switch(a[f]=d,f){case"blur":e.blur(d);break;case"rotation":e.rotate(d,!0);break;case"href":case"title":case"target":var m=s.parentNode;if("a"!=S.call(m.tagName)){var v=Oe("a");m.insertBefore(v,s),v[p](s),m=v}"target"==f&&"blank"==d?m.setAttributeNS(e.paper.xlink,"show","new"):m.setAttributeNS(e.paper.xlink,f,d);break;case"cursor":s.style.cursor=d;break;case"clip-rect":var w=b(d)[x](r);if(4==w[E]){e.clip&&e.clip.parentNode.parentNode.removeChild(e.clip.parentNode);var k=Oe("clipPath"),q=Oe("rect");k.id=ce(),Oe(q,{x:w[0],y:w[1],width:w[2],height:w[3]}),k[p](q),e.paper.defs[p](k),Oe(s,{"clip-path":"url(#"+k.id+")"}),e.clip=q}if(!d){var j=u.getElementById(s.getAttribute("clip-path")[K](/(^url\(#|\)$)/g,g));j&&j.parentNode.removeChild(j),Oe(s,{"clip-path":g}),delete e.clip}break;case"path":"path"==e.type&&Oe(s,{d:d?a.path=ye(d):"M0,0"});break;case"width":if(s[z](f,d),!a.fx)break;f="x",d=a.x;case"x":a.fx&&(d=-a.x-(a.width||0));case"rx":if("rx"==f&&"rect"==e.type)break;case"cx":l&&("x"==f||"cx"==f)&&(l[1]+=d-a[f]),s[z](f,d),e.pattern&&Le(e);break;case"height":if(s[z](f,d),!a.fy)break;f="y",d=a.y;case"y":a.fy&&(d=-a.y-(a.height||0));case"ry":if("ry"==f&&"rect"==e.type)break;case"cy":l&&("y"==f||"cy"==f)&&(l[2]+=d-a[f]),s[z](f,d),e.pattern&&Le(e);break;case"r":"rect"==e.type?Oe(s,{rx:d,ry:d}):s[z](f,d);break;case"src":"image"==e.type&&s.setAttributeNS(e.paper.xlink,"href",d);break;case"stroke-width":s.style.strokeWidth=d,s[z](f,d),a["stroke-dasharray"]&&h(e,a["stroke-dasharray"]);break;case"stroke-dasharray":h(e,d);break;case"translation":var M=b(d)[x](r);M[0]=+M[0]||0,M[1]=+M[1]||0,l&&(l[1]+=M[0],l[2]+=M[1]),Mi.call(e,M[0],M[1]);break;case"scale":M=b(d)[x](r),e.scale(+M[0]||1,+M[1]||+M[0]||1,isNaN(G(M[2]))?null:+M[2],isNaN(G(M[3]))?null:+M[3]);break;case B:var A=b(d).match(D);if(A){k=Oe("pattern");var N=Oe("image");k.id=ce(),Oe(k,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Oe(N,{x:0,y:0}),N.setAttributeNS(e.paper.xlink,"href",A[1]),k[p](N);var I=u.createElement("img");I.style.cssText="position:absolute;left:-9999em;top-9999em",I.onload=function(){Oe(k,{width:this.offsetWidth,height:this.offsetHeight}),Oe(N,{width:this.offsetWidth,height:this.offsetHeight}),u.body.removeChild(this),e.paper.safari()},u.body[p](I),I.src=A[1],e.paper.defs[p](k),s.style.fill="url(#"+k.id+")",Oe(s,{fill:"url(#"+k.id+")"}),e.pattern=k,e.pattern&&Le(e);break}var U=t.getRGB(d);if(U.error){if(({circle:1,ellipse:1}[o](e.type)||"r"!=b(d).charAt())&&Be(s,d,e.paper)){a.gradient=d,a.fill="none";break}delete i.gradient,delete a.gradient,!t.is(a.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Oe(s,{opacity:a.opacity}),!t.is(a["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Oe(s,{"fill-opacity":a["fill-opacity"]})}U[o]("opacity")&&Oe(s,{"fill-opacity":U.opacity>1?U.opacity/100:U.opacity});case"stroke":U=t.getRGB(d),s[z](f,U.hex),"stroke"==f&&U[o]("opacity")&&Oe(s,{"stroke-opacity":U.opacity>1?U.opacity/100:U.opacity});break;case"gradient":(({circle:1,ellipse:1})[o](e.type)||"r"!=b(d).charAt())&&Be(s,d,e.paper);break;case"opacity":a.gradient&&!a[o]("stroke-opacity")&&Oe(s,{"stroke-opacity":d>1?d/100:d});case"fill-opacity":if(a.gradient){var C=u.getElementById(s.getAttribute(B)[K](/^url\(#|\)$/g,g));if(C){var O=C.getElementsByTagName("stop");O[O[E]-1][z]("stop-opacity",d)}break}default:"font-size"==f&&(d=F(d,10)+"px");var _=f[K](/(\-.)/g,function(t){return Z.call(t.substring(1))});s.style[_]=d,s[z](f,d)}}De(e,i),l?e.rotate(l.join(y)):G(c)&&e.rotate(c,!0)},Re=1.2,De=function(e,i){if("text"==e.type&&(i[o]("text")||i[o]("font")||i[o]("font-size")||i[o]("x")||i[o]("y"))){var r=e.attrs,n=e.node,s=n.firstChild?F(u.defaultView.getComputedStyle(n.firstChild,g).getPropertyValue("font-size"),10):10;if(i[o]("text")){for(r.text=i.text;n.firstChild;)n.removeChild(n.firstChild);for(var a=b(i.text)[x]("\n"),c=0,h=a[E];h>c;c++)if(a[c]){var l=Oe("tspan");c&&Oe(l,{dy:s*Re,x:r.x}),l[p](u.createTextNode(a[c])),n[p](l)}}else for(a=n.getElementsByTagName("tspan"),c=0,h=a[E];h>c;c++)c&&Oe(a[c],{dy:s*Re,x:r.x});Oe(n,{y:r.y});var f=e.getBBox(),d=r.y-(f.y+f.height/2);d&&t.is(d,"finite")&&Oe(n,{y:r.y+d})}},Xe=function(e,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Ye=Xe[a];Xe[a].rotate=function(e,i,n){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](y):this._.rt.deg;var s=this.getBBox();return e=b(e)[x](r),e[E]-1&&(i=G(e[1]),n=G(e[2])),e=G(e[0]),null!=i&&i!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==n&&(i=null),this._.rt.cx=i,this._.rt.cy=n,i=null==i?s.x+s.width/2:i,n=null==n?s.y+s.height/2:n,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,n),this.clip&&Oe(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,n)})):(this.transformations[0]=g,this.clip&&Oe(this.clip,{transform:g})),Oe(this.node,{transform:this.transformations[T](y)}),this},Xe[a].hide=function(){return!this.removed&&(this.node.style.display="none"),this},Xe[a].show=function(){return!this.removed&&(this.node.style.display=""),this},Xe[a].remove=function(){if(!this.removed){Me(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},Xe[a].getBBox=function(){if(this.removed)return this;if("path"==this.type)return me(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var i=0,r=this.node.getNumberOfChars();r>i;i++){var n=this.node.getExtentOfChar(i);n.y<e.y&&(e.y=n.y),n.y+n.height-e.y>e.height&&(e.height=n.y+n.height-e.y),n.x+n.width-e.x>e.width&&(e.width=n.x+n.width-e.x)}}return t&&this.hide(),e},Xe[a].attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[o](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,C))return"translation"==e?Mi.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==B&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==i&&t.is(e,O)){for(var s={},a=0,u=e.length;u>a;a++)s[e[a]]=this.attr(e[a]);return s}if(null!=i){var c={};c[e]=i}else null!=e&&t.is(e,"object")&&(c=e);for(var h in this.paper.customAttributes)if(this.paper.customAttributes[o](h)&&c[o](h)&&t.is(this.paper.customAttributes[h],"function")){var l=this.paper.customAttributes[h].apply(this,[][m](c[h]));this.attrs[h]=c[h];for(var f in l)l[o](f)&&(c[f]=l[f])}return Pe(this,c),this},Xe[a].toFront=function(){if(this.removed)return this;this.node.parentNode[p](this.node);var t=this.paper;return t.top!=this&&Ae(this,t),this},Xe[a].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Ne(this,this.paper);{this.paper}}return this},Xe[a].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[p](this.node),Ie(this,t,this.paper),this},Xe[a].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),Ue(this,t,this.paper),this},Xe[a].blur=function(t){var e=this;if(0!==+t){var i=Oe("filter"),r=Oe("feGaussianBlur");e.attrs.blur=t,i.id=ce(),Oe(r,{stdDeviation:+t||1.5}),i.appendChild(r),e.paper.defs.appendChild(i),e._blur=i,Oe(e.node,{filter:"url(#"+i.id+")"})}else e._blur&&(e._blur.parentNode.removeChild(e._blur),delete e._blur,delete e.attrs.blur),e.node.removeAttribute("filter")};var Ve=function(t,e,i,r){var n=Oe("circle");t.canvas&&t.canvas[p](n);var s=new Xe(n,t);return s.attrs={cx:e,cy:i,r:r,fill:"none",stroke:"#000"},s.type="circle",Oe(n,s.attrs),s},He=function(t,e,i,r,n,s){var a=Oe("rect");t.canvas&&t.canvas[p](a);var o=new Xe(a,t);return o.attrs={x:e,y:i,width:r,height:n,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},o.type="rect",Oe(a,o.attrs),o},ze=function(t,e,i,r,n){var s=Oe("ellipse");t.canvas&&t.canvas[p](s);var a=new Xe(s,t);return a.attrs={cx:e,cy:i,rx:r,ry:n,fill:"none",stroke:"#000"},a.type="ellipse",Oe(s,a.attrs),a},Ge=function(t,e,i,r,n,s){var a=Oe("image");Oe(a,{x:i,y:r,width:n,height:s,preserveAspectRatio:"none"}),a.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[p](a);var o=new Xe(a,t);return o.attrs={x:i,y:r,width:n,height:s,src:e},o.type="image",o},Fe=function(t,e,i,r){var n=Oe("text");Oe(n,{x:e,y:i,"text-anchor":"middle"}),t.canvas&&t.canvas[p](n);var s=new Xe(n,t);return s.attrs={x:e,y:i,"text-anchor":"middle",text:r,font:$.font,stroke:"none",fill:"#000"},s.type="text",Pe(s,s.attrs),s},We=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas[z]("width",this.width),this.canvas[z]("height",this.height),this},Ze=function(){var e=qe[d](0,arguments),i=e&&e.container,r=e.x,n=e.y,s=e.width,a=e.height;if(!i)throw new Error("SVG container not found.");var o=Oe("svg");return r=r||0,n=n||0,s=s||512,a=a||342,Oe(o,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:s,height:a}),1==i?(o.style.cssText="position:absolute;left:"+r+"px;top:"+n+"px",u.body[p](o)):i.firstChild?i.insertBefore(o,i.firstChild):i[p](o),i=new l,i.width=s,i.height=a,i.canvas=o,je.call(i,i,t.fn),i.clear(),i};f.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=Oe("desc"))[p](u.createTextNode("Created with Raphaël")),t[p](this.desc),t[p](this.defs=Oe("defs"))},f.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Ce(t)}}if(t.vml){var $e={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Qe=/([clmz]),?([^clmz]*)/gi,Ke=/ progid:\S+Blur\([^\)]+\)/g,Je=/-?[^,\s-]+/g,ti=1e3+y+1e3,ei=10,ri={path:1,rect:1},ni=function(t){var e=/[ahqstv]/gi,i=ye;if(b(t).match(e)&&(i=Ee),e=/[clmz]/g,i==ye&&!b(t).match(e)){var r=b(t)[K](Qe,function(t,e,i){var r=[],n="m"==S.call(e),s=$e[e];return i[K](Je,function(t){n&&2==r[E]&&(s+=r+$e["m"==e?"l":"L"],r=[]),r[R](H(t*ei))}),s+r});return r}var s,a,n=i(t);r=[];for(var o=0,u=n[E];u>o;o++){s=n[o],a=S.call(n[o][0]),"z"==a&&(a="x");for(var c=1,h=s[E];h>c;c++)a+=H(s[c]*ei)+(c!=h-1?",":g);r[R](a)}return r[T](y)};t[_]=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version},_e=function(t,e){var i=ai("group");i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=e.coordsize,i.coordorigin=e.coordorigin;var r=ai("shape"),n=r.style;n.width=e.width+"px",n.height=e.height+"px",r.coordsize=ti,r.coordorigin=e.coordorigin,i[p](r);var s=new Xe(r,i,e),a={fill:"none",stroke:"#000"};return t&&(a.path=t),s.type="path",s.path=[],s.Path=g,Pe(s,a),e.canvas[p](i),s},Pe=function(e,i){e.attrs=e.attrs||{};var c,n=e.node,s=e.attrs,a=n.style,h=(i.x!=s.x||i.y!=s.y||i.width!=s.width||i.height!=s.height||i.r!=s.r)&&"rect"==e.type,l=e;for(var f in i)i[o](f)&&(s[f]=i[f]);if(h&&(s.path=si(s.x,s.y,s.width,s.height,s.r),e.X=s.x,e.Y=s.y,e.W=s.width,e.H=s.height),i.href&&(n.href=i.href),i.title&&(n.title=i.title),i.target&&(n.target=i.target),i.cursor&&(a.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||h)&&(n.path=ni(s.path)),null!=i.rotation&&e.rotate(i.rotation,!0),i.translation&&(c=b(i.translation)[x](r),Mi.call(e,c[0],c[1]),null!=e._.rt.cx&&(e._.rt.cx+=+c[0],e._.rt.cy+=+c[1],e.setBox(e.attrs,c[0],c[1]))),i.scale&&(c=b(i.scale)[x](r),e.scale(+c[0]||1,+c[1]||+c[0]||1,+c[2]||null,+c[3]||null)),"clip-rect"in i){var d=b(i["clip-rect"])[x](r);if(4==d[E]){d[2]=+d[2]+ +d[0],d[3]=+d[3]+ +d[1];var m=n.clipRect||u.createElement("div"),v=m.style,y=n.parentNode;v.clip=t.format("rect({1}px {2}px {3}px {0}px)",d),n.clipRect||(v.position="absolute",v.top=0,v.left=0,v.width=e.paper.width+"px",v.height=e.paper.height+"px",y.parentNode.insertBefore(m,y),m[p](y),n.clipRect=m)}i["clip-rect"]||n.clipRect&&(n.clipRect.style.clip=g)}if("image"==e.type&&i.src&&(n.src=i.src),"image"==e.type&&i.opacity&&(n.filterOpacity=W+".Alpha(opacity="+100*i.opacity+")",a.filter=(n.filterMatrix||g)+(n.filterOpacity||g)),i.font&&(a.font=i.font),i["font-family"]&&(a.fontFamily='"'+i["font-family"][x](",")[0][K](/^['"]+|['"]+$/g,g)+'"'),i["font-size"]&&(a.fontSize=i["font-size"]),i["font-weight"]&&(a.fontWeight=i["font-weight"]),i["font-style"]&&(a.fontStyle=i["font-style"]),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){n=e.shape||n;var w=n.getElementsByTagName(B)&&n.getElementsByTagName(B)[0],k=!1;if(!w&&(k=w=ai(B)),"fill-opacity"in i||"opacity"in i){var T=((+s["fill-opacity"]+1||2)-1)*((+s.opacity+1||2)-1)*((+t.getRGB(i.fill).o+1||2)-1);T=M(j(T,0),1),w.opacity=T}if(i.fill&&(w.on=!0),(null==w.on||"none"==i.fill)&&(w.on=!1),w.on&&i.fill){var S=i.fill.match(D);S?(w.src=S[1],w.type="tile"):(w.color=t.getRGB(i.fill).hex,w.src=g,w.type="solid",t.getRGB(i.fill).error&&(l.type in{circle:1,ellipse:1}||"r"!=b(i.fill).charAt())&&Be(l,i.fill)&&(s.fill="none",s.gradient=i.fill))}k&&n[p](w);var q=n.getElementsByTagName("stroke")&&n.getElementsByTagName("stroke")[0],A=!1;!q&&(A=q=ai("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(q.on=!0),("none"==i.stroke||null==q.on||0==i.stroke||0==i["stroke-width"])&&(q.on=!1);var N=t.getRGB(i.stroke);q.on&&i.stroke&&(q.color=N.hex),T=((+s["stroke-opacity"]+1||2)-1)*((+s.opacity+1||2)-1)*((+N.o+1||2)-1);var I=.75*(G(i["stroke-width"])||1);if(T=M(j(T,0),1),null==i["stroke-width"]&&(I=s["stroke-width"]),i["stroke-width"]&&(q.weight=I),I&&1>I&&(T*=I)&&(q.weight=1),q.opacity=T,i["stroke-linejoin"]&&(q.joinstyle=i["stroke-linejoin"]||"miter"),q.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(q.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var U={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};
q.dashstyle=U[o](i["stroke-dasharray"])?U[i["stroke-dasharray"]]:g}A&&n[p](q)}if("text"==l.type)switch(a=l.paper.span.style,s.font&&(a.font=s.font),s["font-family"]&&(a.fontFamily=s["font-family"]),s["font-size"]&&(a.fontSize=s["font-size"]),s["font-weight"]&&(a.fontWeight=s["font-weight"]),s["font-style"]&&(a.fontStyle=s["font-style"]),l.node.string&&(l.paper.span.innerHTML=b(l.node.string)[K](/</g,"&#60;")[K](/&/g,"&#38;")[K](/\n/g,"<br>")),l.W=s.w=l.paper.span.offsetWidth,l.H=s.h=l.paper.span.offsetHeight,l.X=s.x,l.Y=s.y+H(l.H/2),s["text-anchor"]){case"start":l.node.style["v-text-align"]="left",l.bbx=H(l.W/2);break;case"end":l.node.style["v-text-align"]="right",l.bbx=-H(l.W/2);break;default:l.node.style["v-text-align"]="center"}},Be=function(t,e){t.attrs=t.attrs||{};var r,n=(t.attrs,"linear"),s=".5 .5";if(t.attrs.gradient=e,e=b(e)[K](se,function(t,e,i){return n="radial",e&&i&&(e=G(e),i=G(i),N(e-.5,2)+N(i-.5,2)>.25&&(i=q.sqrt(.25-N(e-.5,2))*(2*(i>.5)-1)+.5),s=e+y+i),g}),e=e[x](/\s*\-\s*/),"linear"==n){var a=e.shift();if(a=-G(a),isNaN(a))return null}var o=Se(e);if(!o)return null;if(t=t.shape||t.node,r=t.getElementsByTagName(B)[0]||ai(B),!r.parentNode&&t.appendChild(r),o[E]){r.on=!0,r.method="none",r.color=o[0].color,r.color2=o[o[E]-1].color;for(var u=[],c=0,h=o[E];h>c;c++)o[c].offset&&u[R](o[c].offset+y+o[c].color);r.colors&&(r.colors.value=u[E]?u[T]():"0% "+r.color),"radial"==n?(r.type="gradientradial",r.focus="100%",r.focussize=s,r.focusposition=s):(r.type="gradient",r.angle=(270-a)%360)}return 1},Xe=function(e,i,r){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=i,this.paper=r,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},Ye=Xe[a],Ye.rotate=function(t,e,i){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](y):this._.rt.deg:(t=b(t)[x](r),t[E]-1&&(e=G(t[1]),i=G(t[2])),t=G(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==i&&(e=null),this._.rt.cx=e,this._.rt.cy=i,this.setBox(this.attrs,e,i),this.Group.style.rotation=this._.rt.deg,this)},Ye.setBox=function(t,e,i){if(this.removed)return this;var r=this.Group.style,n=this.shape&&this.shape.style||this.node.style;t=t||{};for(var s in t)t[o](s)&&(this.attrs[s]=t[s]);e=e||this._.rt.cx,i=i||this._.rt.cy;var u,c,h,l,a=this.attrs;switch(this.type){case"circle":u=a.cx-a.r,c=a.cy-a.r,h=l=2*a.r;break;case"ellipse":u=a.cx-a.rx,c=a.cy-a.ry,h=2*a.rx,l=2*a.ry;break;case"image":u=+a.x,c=+a.y,h=a.width||0,l=a.height||0;break;case"text":this.textpath.v=["m",H(a.x),", ",H(a.y-2),"l",H(a.x)+1,", ",H(a.y-2)][T](g),u=a.x-H(this.W/2),c=a.y-this.H/2,h=this.W,l=this.H;break;case"rect":case"path":if(this.attrs.path){var f=me(this.attrs.path);u=f.x,c=f.y,h=f.width,l=f.height}else u=0,c=0,h=this.paper.width,l=this.paper.height;break;default:u=0,c=0,h=this.paper.width,l=this.paper.height}e=null==e?u+h/2:e,i=null==i?c+l/2:i;var m,p=e-this.paper.width/2,d=i-this.paper.height/2;r.left!=(m=p+"px")&&(r.left=m),r.top!=(m=d+"px")&&(r.top=m),this.X=ri[o](this.type)?-p:u,this.Y=ri[o](this.type)?-d:c,this.W=h,this.H=l,ri[o](this.type)?(n.left!=(m=-p*ei+"px")&&(n.left=m),n.top!=(m=-d*ei+"px")&&(n.top=m)):"text"==this.type?(n.left!=(m=-p+"px")&&(n.left=m),n.top!=(m=-d+"px")&&(n.top=m)):(r.width!=(m=this.paper.width+"px")&&(r.width=m),r.height!=(m=this.paper.height+"px")&&(r.height=m),n.left!=(m=u-p+"px")&&(n.left=m),n.top!=(m=c-d+"px")&&(n.top=m),n.width!=(m=h+"px")&&(n.width=m),n.height!=(m=l+"px")&&(n.height=m))},Ye.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Ye.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Ye.getBBox=function(){return this.removed?this:ri[o](this.type)?me(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Ye.remove=function(){if(!this.removed){Me(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},Ye.attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[o](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,"string"))return"translation"==e?Mi.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==B&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==i&&t.is(e,O)){var s,a={};for(n=0,s=e[E];s>n;n++)a[e[n]]=this.attr(e[n]);return a}var u;if(null!=i&&(u={},u[e]=i),null==i&&t.is(e,"object")&&(u=e),u){for(var c in this.paper.customAttributes)if(this.paper.customAttributes[o](c)&&u[o](c)&&t.is(this.paper.customAttributes[c],"function")){var h=this.paper.customAttributes[c].apply(this,[][m](u[c]));this.attrs[c]=u[c];for(var l in h)h[o](l)&&(u[l]=h[l])}u.text&&"text"==this.type&&(this.node.string=u.text),Pe(this,u),u.gradient&&({circle:1,ellipse:1}[o](this.type)||"r"!=b(u.gradient).charAt())&&Be(this,u.gradient),(!ri[o](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Ye.toFront=function(){return!this.removed&&this.Group.parentNode[p](this.Group),this.paper.top!=this&&Ae(this,this.paper),this},Ye.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Ne(this,this.paper)),this)},Ye.insertAfter=function(t){return this.removed?this:(t.constructor==Ii&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[p](this.Group),Ie(this,t,this.paper),this)},Ye.insertBefore=function(t){return this.removed?this:(t.constructor==Ii&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),Ue(this,t,this.paper),this)},Ye.blur=function(e){var i=this.node.runtimeStyle,r=i.filter;r=r.replace(Ke,g),0!==+e?(this.attrs.blur=e,i.filter=r+y+W+".Blur(pixelradius="+(+e||1.5)+")",i.margin=t.format("-{0}px 0 0 -{0}px",H(+e||1.5))):(i.filter=r,i.margin=0,delete this.attrs.blur)},Ve=function(t,e,i,r){{var n=ai("group"),s=ai("oval");s.style}n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=ti,n.coordorigin=t.coordorigin,n[p](s);var o=new Xe(s,n,t);return o.type="circle",Pe(o,{stroke:"#000",fill:"none"}),o.attrs.cx=e,o.attrs.cy=i,o.attrs.r=r,o.setBox({x:e-r,y:i-r,width:2*r,height:2*r}),t.canvas[p](n),o},He=function(t,e,i,r,n,s){var a=si(e,i,r,n,s),o=t.path(a),u=o.attrs;return o.X=u.x=e,o.Y=u.y=i,o.W=u.width=r,o.H=u.height=n,u.r=s,u.path=a,o.type="rect",o},ze=function(t,e,i,r,n){{var s=ai("group"),a=ai("oval");a.style}s.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",s.coordsize=ti,s.coordorigin=t.coordorigin,s[p](a);var u=new Xe(a,s,t);return u.type="ellipse",Pe(u,{stroke:"#000"}),u.attrs.cx=e,u.attrs.cy=i,u.attrs.rx=r,u.attrs.ry=n,u.setBox({x:e-r,y:i-n,width:2*r,height:2*n}),t.canvas[p](s),u},Ge=function(t,e,i,r,n,s){var a=ai("group"),o=ai("image");a.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",a.coordsize=ti,a.coordorigin=t.coordorigin,o.src=e,a[p](o);var u=new Xe(o,a,t);return u.type="image",u.attrs.src=e,u.attrs.x=i,u.attrs.y=r,u.attrs.w=n,u.attrs.h=s,u.setBox({x:i,y:r,width:n,height:s}),t.canvas[p](a),u},Fe=function(e,i,r,n){var s=ai("group"),a=ai("shape"),o=a.style,u=ai("path"),h=(u.style,ai("textpath"));s.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",s.coordsize=ti,s.coordorigin=e.coordorigin,u.v=t.format("m{0},{1}l{2},{1}",H(10*i),H(10*r),H(10*i)+1),u.textpathok=!0,o.width=e.width,o.height=e.height,h.string=b(n),h.on=!0,a[p](h),a[p](u),s[p](a);var l=new Xe(h,s,e);return l.shape=a,l.textpath=u,l.type="text",l.attrs.text=n,l.attrs.x=i,l.attrs.y=r,l.attrs.w=1,l.attrs.h=1,Pe(l,{font:$.font,stroke:"none",fill:"#000"}),l.setBox(),e.canvas[p](s),l},We=function(t,e){var i=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),i.width=t,i.height=e,i.clip="rect(0 "+t+" "+e+" 0)",this};var ai;u.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!u.namespaces.rvml&&u.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ai=function(t){return u.createElement("<rvml:"+t+' class="rvml">')}}catch(t){ai=function(t){return u.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Ze=function(){var e=qe[d](0,arguments),i=e.container,r=e.height,s=e.width,a=e.x,o=e.y;if(!i)throw new Error("VML container not found.");var c=new l,h=c.canvas=u.createElement("div"),f=h.style;return a=a||0,o=o||0,s=s||512,r=r||342,s==+s&&(s+="px"),r==+r&&(r+="px"),c.width=1e3,c.height=1e3,c.coordsize=1e3*ei+y+1e3*ei,c.coordorigin="0 0",c.span=u.createElement("span"),c.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",h[p](c.span),f.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",s,r),1==i?(u.body[p](h),f.left=a+"px",f.top=o+"px",f.position="absolute"):i.firstChild?i.insertBefore(h,i.firstChild):i[p](h),je.call(c,c,t.fn),c},f.clear=function(){this.canvas.innerHTML=g,this.span=u.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[p](this.span),this.bottom=this.top=null},f.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Ce(t);return!0}}var oi=navigator.userAgent.match(/Version\\x2f(.*?)\s/);f.safari="Apple Computer, Inc."==navigator.vendor&&(oi&&oi[1]<4||"iP"==navigator.platform.slice(0,2))?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});c.setTimeout(function(){t.remove()})}:function(){};for(var ui=function(){this.returnValue=!1},ci=function(){return this.originalEvent.preventDefault()},hi=function(){this.cancelBubble=!0},li=function(){return this.originalEvent.stopPropagation()},fi=function(){return u.addEventListener?function(t,e,i,r){var n=v&&k[e]?k[e]:e,s=function(n){if(v&&k[o](e))for(var s=0,a=n.targetTouches&&n.targetTouches.length;a>s;s++)if(n.targetTouches[s].target==t){var u=n;n=n.targetTouches[s],n.originalEvent=u,n.preventDefault=ci,n.stopPropagation=li;break}return i.call(r,n)};return t.addEventListener(n,s,!1),function(){return t.removeEventListener(n,s,!1),!0}}:u.attachEvent?function(t,e,i,r){var n=function(t){return t=t||c.event,t.preventDefault=t.preventDefault||ui,t.stopPropagation=t.stopPropagation||hi,i.call(r,t)};t.attachEvent("on"+e,n);var s=function(){return t.detachEvent("on"+e,n),!0};return s}:void 0}(),pi=[],di=function(t){for(var s,e=t.clientX,i=t.clientY,r=u.documentElement.scrollTop||u.body.scrollTop,n=u.documentElement.scrollLeft||u.body.scrollLeft,a=pi.length;a--;){if(s=pi[a],v){for(var c,o=t.touches.length;o--;)if(c=t.touches[o],c.identifier==s.el._drag.id){e=c.clientX,i=c.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();e+=n,i+=r,s.move&&s.move.call(s.move_scope||s.el,e-s.el._drag.x,i-s.el._drag.y,e,i,t)}},mi=function(e){t.unmousemove(di).unmouseup(mi);for(var r,i=pi.length;i--;)r=pi[i],r.el._drag={},r.end&&r.end.call(r.end_scope||r.start_scope||r.move_scope||r.el,e);pi=[]},vi=w[E];vi--;)(function(e){t[e]=Xe[a][e]=function(i,r){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:e,f:i,unbind:fi(this.shape||this.node||u,e,i,r||this)})),this},t["un"+e]=Xe[a]["un"+e]=function(t){for(var i=this.events,r=i[E];r--;)if(i[r].name==e&&i[r].f==t)return i[r].unbind(),i.splice(r,1),!i.length&&delete this.events,this;return this}})(w[vi]);Ye.hover=function(t,e,i,r){return this.mouseover(t,i).mouseout(e,r||i)},Ye.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},Ye.drag=function(e,i,r,n,s,a){return this._drag={},this.mousedown(function(o){(o.originalEvent||o).preventDefault();var c=u.documentElement.scrollTop||u.body.scrollTop,h=u.documentElement.scrollLeft||u.body.scrollLeft;this._drag.x=o.clientX+h,this._drag.y=o.clientY+c,this._drag.id=o.identifier,i&&i.call(s||n||this,o.clientX+h,o.clientY+c,o),!pi.length&&t.mousemove(di).mouseup(mi),pi.push({el:this,move:e,end:r,move_scope:n,start_scope:s,end_scope:a})}),this},Ye.undrag=function(e,i,r){for(var n=pi.length;n--;)pi[n].el==this&&pi[n].move==e&&pi[n].end==r&&pi.splice(n++,1);!pi.length&&t.unmousemove(di).unmouseup(mi)},f.circle=function(t,e,i){return Ve(this,t||0,e||0,i||0)},f.rect=function(t,e,i,r,n){return He(this,t||0,e||0,i||0,r||0,n||0)},f.ellipse=function(t,e,i,r){return ze(this,t||0,e||0,i||0,r||0)},f.path=function(e){return e&&!t.is(e,C)&&!t.is(e[0],O)&&(e+=g),_e(t.format[d](t,arguments),this)},f.image=function(t,e,i,r,n){return Ge(this,t||"about:blank",e||0,i||0,r||0,n||0)},f.text=function(t,e,i){return Fe(this,t||0,e||0,b(i))},f.set=function(t){return arguments[E]>1&&(t=Array[a].splice.call(arguments,0,arguments[E])),new Ii(t)},f.setSize=We,f.top=f.bottom=null,f.raphael=t,Ye.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,void(this.attrs.scale="1 1"))},Ye.scale=function(t,e,i,r){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:gi};e=e||t,!+e&&(e=t);var n,s,u=this.attrs;if(0!=t){var c=this.getBBox(),h=c.x+c.width/2,l=c.y+c.height/2,f=A(t/this._.sx),p=A(e/this._.sy);i=+i||0==i?i:h,r=+r||0==r?r:l;var d=this._.sx>0,v=this._.sy>0,b=~~(t/A(t)),x=~~(e/A(e)),w=f*b,k=p*x,S=this.node.style,q=i+A(h-i)*w*(h>i==d?1:-1),j=r+A(l-r)*k*(l>r==v?1:-1),M=t*b>e*x?p:f;switch(this.type){case"rect":case"image":var N=u.width*f,I=u.height*p;this.attr({height:I,r:u.r*M,width:N,x:q-N/2,y:j-I/2});break;case"circle":case"ellipse":this.attr({rx:u.rx*f,ry:u.ry*p,r:u.r*M,cx:q,cy:j});break;case"text":this.attr({x:q,y:j});break;case"path":for(var U=ge(u.path),C=!0,O=d?w:f,_=v?k:p,B=0,L=U[E];L>B;B++){var P=U[B],R=Z.call(P[0]);if("M"!=R||!C)if(C=!1,"A"==R)P[U[B][E]-2]*=O,P[U[B][E]-1]*=_,P[1]*=f,P[2]*=p,P[5]=+(b+x?!!+P[5]:!+P[5]);else if("H"==R)for(var D=1,X=P[E];X>D;D++)P[D]*=O;else if("V"==R)for(D=1,X=P[E];X>D;D++)P[D]*=_;else for(D=1,X=P[E];X>D;D++)P[D]*=D%2?O:_}var Y=me(U);n=q-Y.x-Y.width/2,s=j-Y.y-Y.height/2,U[0][1]+=n,U[0][2]+=s,this.attr({path:U})}this.type in{text:1,image:1}&&(1!=b||1!=x)?this.transformations?(this.transformations[2]="scale("[m](b,",",x,")"),this.node[z]("transform",this.transformations[T](y)),n=-1==b?-u.x-(N||0):u.x,s=-1==x?-u.y-(I||0):u.y,this.attr({x:n,y:s}),u.fx=b-1,u.fy=x-1):(this.node.filterMatrix=W+".Matrix(M11="[m](b,", M12=0, M21=0, M22=",x,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),S.filter=(this.node.filterMatrix||g)+(this.node.filterOpacity||g)):this.transformations?(this.transformations[2]=g,this.node[z]("transform",this.transformations[T](y)),u.fx=0,u.fy=0):(this.node.filterMatrix=g,S.filter=(this.node.filterMatrix||g)+(this.node.filterOpacity||g)),u.scale=[t,e,i,r][T](y),this._.sx=t,this._.sy=e}return this},Ye.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var yi={},bi=function(e,i,r,n,s,a,o,u,c){var d,m,h=0,l=100,f=[e,i,r,n,s,a,o,u].join(),p=yi[f];if(!p&&(yi[f]=p={data:[]}),p.timer&&clearTimeout(p.timer),p.timer=setTimeout(function(){delete yi[f]},2e3),null!=c){var v=bi(e,i,r,n,s,a,o,u);l=10*~~v}for(var g=0;l+1>g;g++){if(p.data[c]>g?m=p.data[g*l]:(m=t.findDotsAtSegment(e,i,r,n,s,a,o,u,g/l),p.data[g]=m),g&&(h+=N(N(d.x-m.x,2)+N(d.y-m.y,2),.5)),null!=c&&h>=c)return m;d=m}return null==c?h:void 0},xi=function(e,i){return function(r,n,s){r=Ee(r);for(var a,o,u,c,f,h="",l={},p=0,d=0,m=r.length;m>d;d++){if(u=r[d],"M"==u[0])a=+u[1],o=+u[2];else{if(c=bi(a,o,u[1],u[2],u[3],u[4],u[5],u[6]),p+c>n){if(i&&!l.start){if(f=bi(a,o,u[1],u[2],u[3],u[4],u[5],u[6],n-p),h+=["C",f.start.x,f.start.y,f.m.x,f.m.y,f.x,f.y],s)return h;l.start=h,h=["M",f.x,f.y+"C",f.n.x,f.n.y,f.end.x,f.end.y,u[5],u[6]][T](),p+=c,a=+u[5],o=+u[6];continue}if(!e&&!i)return f=bi(a,o,u[1],u[2],u[3],u[4],u[5],u[6],n-p),{x:f.x,y:f.y,alpha:f.alpha}}p+=c,a=+u[5],o=+u[6]}h+=u}return l.end=h,f=e?p:i?l:t.findDotsAtSegment(a,o,u[1],u[2],u[3],u[4],u[5],u[6],1),f.alpha&&(f={x:f.x,y:f.y,alpha:f.alpha}),f}},wi=xi(1),ki=xi(),Ti=xi(0,1);Ye.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():wi(this.attrs.path):void 0},Ye.getPointAtLength=function(t){return"path"==this.type?ki(this.attrs.path,t):void 0},Ye.getSubpath=function(t,e){if("path"==this.type){if(A(this.getTotalLength()-e)<"1e-6")return Ti(this.attrs.path,t).end;var i=Ti(this.attrs.path,e,1);return t?Ti(i,t).end:i}},t.easing_formulas={linear:function(t){return t},"<":function(t){return N(t,3)},">":function(t){return N(t-1,3)+1},"<>":function(t){return t=2*t,1>t?N(t,3)/2:(t-=2,(N(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,i=e/4;return N(2,-10*t)*q.sin(2*(t-i)*I/e)+1},bounce:function(t){var r,e=7.5625,i=2.75;return 1/i>t?r=e*t*t:2/i>t?(t-=1.5/i,r=e*t*t+.75):2.5/i>t?(t-=2.25/i,r=e*t*t+.9375):(t-=2.625/i,r=e*t*t+.984375),r}};var Ei=[],Si=function(){for(var e=+new Date,i=0;i<Ei[E];i++){var r=Ei[i];if(!r.stop&&!r.el.removed){var d,n=e-r.start,s=r.ms,a=r.easing,u=r.from,c=r.diff,h=r.to,l=r.t,f=r.el,p={};if(s>n){var m=a(n/s);for(var v in u)if(u[o](v)){switch(Q[v]){case"along":d=m*s*c[v],h.back&&(d=h.len-d);var b=ki(h[v],d);f.translate(c.sx-c.x||0,c.sy-c.y||0),c.x=b.x,c.y=b.y,f.translate(b.x-c.sx,b.y-c.sy),h.rot&&f.rotate(c.r+b.alpha,b.x,b.y);break;case U:d=+u[v]+m*s*c[v];break;case"colour":d="rgb("+[ji(H(u[v].r+m*s*c[v].r)),ji(H(u[v].g+m*s*c[v].g)),ji(H(u[v].b+m*s*c[v].b))][T](",")+")";break;case"path":d=[];for(var x=0,w=u[v][E];w>x;x++){d[x]=[u[v][x][0]];for(var k=1,S=u[v][x][E];S>k;k++)d[x][k]=+u[v][x][k]+m*s*c[v][x][k];d[x]=d[x][T](y)}d=d[T](y);break;case"csv":switch(v){case"translation":var q=m*s*c[v][0]-l.x,j=m*s*c[v][1]-l.y;l.x+=q,l.y+=j,d=q+y+j;break;case"rotation":d=+u[v][0]+m*s*c[v][0],u[v][1]&&(d+=","+u[v][1]+","+u[v][2]);break;case"scale":d=[+u[v][0]+m*s*c[v][0],+u[v][1]+m*s*c[v][1],2 in h[v]?h[v][2]:g,3 in h[v]?h[v][3]:g][T](y);break;case"clip-rect":for(d=[],x=4;x--;)d[x]=+u[v][x]+m*s*c[v][x]}break;default:var M=[].concat(u[v]);for(d=[],x=f.paper.customAttributes[v].length;x--;)d[x]=+M[x]+m*s*c[v][x]}p[v]=d}f.attr(p),f._run&&f._run.call(f)}else h.along&&(b=ki(h.along,h.len*!h.back),f.translate(c.sx-(c.x||0)+b.x-c.sx,c.sy-(c.y||0)+b.y-c.sy),h.rot&&f.rotate(c.r+b.alpha,b.x,b.y)),(l.x||l.y)&&f.translate(-l.x,-l.y),h.scale&&(h.scale+=g),f.attr(h),Ei.splice(i--,1)}}t.svg&&f&&f.paper&&f.paper.safari(),Ei[E]&&setTimeout(Si)},qi=function(e,i,r,n,s){var a=r-n;i.timeouts.push(setTimeout(function(){t.is(s,"function")&&s.call(i),i.animate(e,a,e.easing)},n))},ji=function(t){return j(M(t,255),0)},Mi=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:gi};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var i=ge(this.attrs.path);i[0][1]+=+t,i[0][2]+=+e,this.attr({path:i})}return this};Ye.animateWith=function(t,e,i,r,n){for(var s=0,a=Ei.length;a>s;s++)Ei[s].el.id==t.id&&(e.start=Ei[s].start);return this.animate(e,i,r,n)},Ye.animateAlong=Ai(),Ye.animateAlongBack=Ai(1),Ye.onAnimation=function(t){return this._run=t||0,this},Ye.animate=function(e,i,n,s){var a=this;if(a.timeouts=a.timeouts||[],(t.is(n,"function")||!n)&&(s=n||null),a.removed)return s&&s.call(a),a;var u={},c={},h=!1,l={};for(var f in e)if(e[o](f)&&(Q[o](f)||a.paper.customAttributes[o](f)))switch(h=!0,u[f]=a.attr(f),null==u[f]&&(u[f]=$[f]),c[f]=e[f],Q[f]){case"along":var p=wi(e[f]),d=ki(e[f],p*!!e.back),m=a.getBBox();l[f]=p/i,l.tx=m.x,l.ty=m.y,l.sx=d.x,l.sy=d.y,c.rot=e.rot,c.back=e.back,c.len=p,e.rot&&(l.r=G(a.rotate())||0);break;case U:l[f]=(c[f]-u[f])/i;break;case"colour":u[f]=t.getRGB(u[f]);var v=t.getRGB(c[f]);l[f]={r:(v.r-u[f].r)/i,g:(v.g-u[f].g)/i,b:(v.b-u[f].b)/i};break;case"path":var g=Ee(u[f],c[f]);u[f]=g[0];var y=g[1];l[f]=[];for(var w=0,k=u[f][E];k>w;w++){l[f][w]=[0];for(var T=1,S=u[f][w][E];S>T;T++)l[f][w][T]=(y[w][T]-u[f][w][T])/i}break;case"csv":var q=b(e[f])[x](r),j=b(u[f])[x](r);switch(f){case"translation":u[f]=[0,0],l[f]=[q[0]/i,q[1]/i];break;case"rotation":u[f]=j[1]==q[1]&&j[2]==q[2]?j:[0,q[1],q[2]],l[f]=[(q[0]-u[f][0])/i,0,0];break;case"scale":e[f]=q,u[f]=b(u[f])[x](r),l[f]=[(q[0]-u[f][0])/i,(q[1]-u[f][1])/i,0,0];break;case"clip-rect":for(u[f]=b(u[f])[x](r),l[f]=[],w=4;w--;)l[f][w]=(q[w]-u[f][w])/i}c[f]=q;break;default:for(q=[].concat(e[f]),j=[].concat(u[f]),l[f]=[],w=a.paper.customAttributes[f][E];w--;)l[f][w]=((q[w]||0)-(j[w]||0))/i}if(h){var M=t.easing_formulas[n];if(!M)if(M=b(n).match(V),M&&5==M[E]){var A=M;M=function(t){return Ni(t,+A[1],+A[2],+A[3],+A[4],i)}}else M=function(t){return t};Ei.push({start:e.start||+new Date,ms:i,easing:M,from:u,diff:l,to:c,el:a,t:{x:0,y:0}}),t.is(s,"function")&&(a._ac=setTimeout(function(){s.call(a)},i)),1==Ei[E]&&setTimeout(Si)}else{var I,N=[];for(var C in e)e[o](C)&&J.test(C)&&(f={value:e[C]},"from"==C&&(C=0),"to"==C&&(C=100),f.key=F(C,10),N.push(f));for(N.sort(ae),N[0].key&&N.unshift({key:0,value:a.attrs}),w=0,k=N[E];k>w;w++)qi(N[w].value,a,i/100*N[w].key,i/100*(N[w-1]&&N[w-1].key||0),N[w-1]&&N[w-1].value.callback);I=N[N[E]-1].value.callback,I&&a.timeouts.push(setTimeout(function(){I.call(a)},i))}return this},Ye.stop=function(){for(var t=0;t<Ei.length;t++)Ei[t].el.id==this.id&&Ei.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;ii>t;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Ye.translate=function(t,e){return this.attr({translation:t+" "+e})},Ye[_]=function(){return"Raphaël’s object"},t.ae=Ei;var Ii=function(t){if(this.items=[],this[E]=0,this.type="set",t)for(var e=0,i=t[E];i>e;e++)!t[e]||t[e].constructor!=Xe&&t[e].constructor!=Ii||(this[this.items[E]]=this.items[this.items[E]]=t[e],this[E]++)};Ii[a][R]=function(){for(var t,e,i=0,r=arguments[E];r>i;i++)t=arguments[i],!t||t.constructor!=Xe&&t.constructor!=Ii||(e=this.items[E],this[e]=this.items[e]=t,this[E]++);return this},Ii[a].pop=function(){return delete this[this[E]--],this.items.pop()};for(var Ui in Ye)Ye[o](Ui)&&(Ii[a][Ui]=function(t){return function(){for(var e=0,i=this.items[E];i>e;e++)this.items[e][t][d](this.items[e],arguments);return this}}(Ui));Ii[a].attr=function(e,i){if(e&&t.is(e,O)&&t.is(e[0],"object"))for(var r=0,n=e[E];n>r;r++)this.items[r].attr(e[r]);else for(var s=0,a=this.items[E];a>s;s++)this.items[s].attr(e,i);return this},Ii[a].animate=function(e,i,r,n){(t.is(r,"function")||!r)&&(n=r||null);var o,c,s=this.items[E],a=s,u=this;for(n&&(c=function(){!--s&&n.call(u)}),r=t.is(r,C)?r:c,o=this.items[--a].animate(e,i,r,c);a--;)this.items[a]&&!this.items[a].removed&&this.items[a].animateWith(o,e,i,r,c);return this},Ii[a].insertAfter=function(t){for(var e=this.items[E];e--;)this.items[e].insertAfter(t);return this},Ii[a].getBBox=function(){for(var t=[],e=[],i=[],r=[],n=this.items[E];n--;){var s=this.items[n].getBBox();t[R](s.x),e[R](s.y),i[R](s.x+s.width),r[R](s.y+s.height)}return t=M[d](0,t),e=M[d](0,e),{x:t,y:e,width:j[d](0,i)-t,height:j[d](0,r)-e}},Ii[a].clone=function(t){t=new Ii;for(var e=0,i=this.items[E];i>e;e++)t[R](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var r in t.face)t.face[o](r)&&(e.face[r]=t.face[r]);if(this.fonts[i]?this.fonts[i][R](e):this.fonts[i]=[e],!t.svg){e.face["units-per-em"]=F(t.face["units-per-em"],10);for(var n in t.glyphs)if(t.glyphs[o](n)){var s=t.glyphs[n];if(e.glyphs[n]={w:s.w,k:{},d:s.d&&"M"+s.d[K](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var a in s.k)s[o](a)&&(e.glyphs[n].k[a]=s.k[a])}}return t},f.getFont=function(e,i,r,n){if(n=n||"normal",r=r||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,t.fonts){var s=t.fonts[e];if(!s){var a=new RegExp("(^|\\s)"+e[K](/[^\w\d\s+!~.:_-]/g,g)+"(\\s|$)","i");for(var u in t.fonts)if(t.fonts[o](u)&&a.test(u)){s=t.fonts[u];break}}var c;if(s)for(var h=0,l=s[E];l>h&&(c=s[h],c.face["font-weight"]!=i||c.face["font-style"]!=r&&c.face["font-style"]||c.face["font-stretch"]!=n);h++);return c}},f.print=function(e,i,n,s,a,o,u){o=o||"middle",u=j(M(u||0,1),-1);var p,c=this.set(),h=b(n)[x](g),l=0;if(t.is(s,n)&&(s=this.getFont(s)),s){p=(a||16)/s.face["units-per-em"];for(var d=s.face.bbox.split(r),m=+d[0],v=+d[1]+("baseline"==o?d[3]-d[1]+ +s.face.descent:(d[3]-d[1])/2),y=0,w=h[E];w>y;y++){var k=y&&s.glyphs[h[y-1]]||{},T=s.glyphs[h[y]];l+=y?(k.w||s.w)+(k.k&&k.k[h[y]]||0)+s.w*u:0,T&&T.d&&c[R](this.path(T.d).attr({fill:"#000",stroke:"none",translation:[l,0]}))}c.scale(p,p,m,v).translate(e-m,i-v)}return c},t.format=function(e,i){var r=t.is(i,O)?[0][m](i):arguments;return e&&t.is(e,C)&&r[E]-1&&(e=e[K](s,function(t,e){return null==r[++e]?g:r[e]})),e||g},t.ninja=function(){return h.was?c.Raphael=h.is:delete e,t},t.el=Ye,t.st=Ii[a],h.was?c.Raphael=t:e=t}(),t=e}),define("scripts/lib/sound.js",function(t){function n(t){this.sound=new e.sound(t,r)}function s(){}var e=require("scripts/lib/buzz"),i=e.isSupported(),r={formats:["ogg","mp3"],preload:!0,autoload:!0,loop:!1};return n.prototype.play=function(t){t=this.sound,t.setPercent(0),t.setVolume(100),t.play()},n.prototype.stop=function(){this.sound.fadeOut(1e3,function(){this.pause()})},t.create=function(t){return i?new n(t):s},s.play=s.stop=function(){},t}),define("scripts/lib/tween.js",function(t){return t.exponential=function(){},t.exponential.co=function(t,e,i,r){return t==r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e},t.bounce=function(){},t.bounce.co=function(t,e,i,r){return(t/=r)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.quadratic=function(){},t.quadratic.ci=function(t,e,i,r){return i*(t/=r)*t+e},t.quadratic.co=function(t,e,i,r){return-i*(t/=r)*(t-2)+e},t.quadratic.cio=function(t,e,i,r){return(t/=r/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.circular=function(t,e,i,r){return(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.linear=function(t,e,i,r){return i*t/r+e},t.back=function(){},t.back.ci=function(t,e,i,r,n){return n=1.70158,i*(t/=r)*t*((n+1)*t-n)+e},t.back.co=function(t,e,i,r,n){return n=1.70158,i*((t=t/r-1)*t*((n+1)*t+n)+1)+e},t}),define("scripts/lib/ucren.js",function(exports){var Ucren,blankArray=[],slice=blankArray.slice,join=blankArray.join;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")}),String.prototype.format=function(t){var e=this;return Ucren.each(t,function(t,i){t=t.toString().replace(/\$/g,"$$$$"),e=e.replace(RegExp("@{"+i+"}","g"),t)}),e.toString()},String.prototype.htmlEncode=function(){var t=document.createElement("div");return function(){var e;return t.appendChild(document.createTextNode(this)),e=t.innerHTML,t.innerHTML="",e}}(),String.prototype.byteLength=function(){return this.replace(/[^\x00-\xff]/g,"  ").length},String.prototype.subByte=function(t,e){var i=this;return i.byteLength()<=t?i:(e=e||"",t-=e.byteLength(),i=i.slice(0,t).replace(/( [^\x00-\xff] )/g,"$1 ").slice(0,t).replace(/[^\x00-\xff]$/,"").replace(/( [^\x00-\xff] ) /g,"$1")+e)},Function.prototype.defer=function(t,e){var i=this,r=function(){i.apply(t,arguments)};return setTimeout(r,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;return function(){return e.apply(t,arguments)}}),Function.prototype.saturate=function(t){var e=this,i=slice.call(arguments,1);return function(){return e.apply(t,slice.call(arguments,0).concat(i))}},Array.prototype.indexOf=function(t,e){var i=this.length;for(e||(e=0),0>e&&(e=i+e);i>e;e++)if(this[e]===t)return e;return-1},Array.prototype.every=function(t,e){for(var i=0,r=this.length;r>i;i++)if(!t.call(e,this[i],i,this))return!1;return!0},Array.prototype.filter=function(t,e){for(var r,i=[],n=0,s=this.length;s>n;n++)r=this[n],t.call(e,r,n,this)&&i.push(r);return i},Array.prototype.forEach=function(t,e){for(var i=0,r=this.length;r>i;i++)t.call(e,this[i],i,this)},Array.prototype.map=function(t,e){for(var i=[],r=0,n=this.length;n>r;r++)i[r]=t.call(e,this[r],r,this);return i},Array.prototype.some=function(t,e){for(var i=0,r=this.length;r>i;i++)if(t.call(e,this[i],i,this))return!0;return!1},Array.prototype.invoke=function(t){var e=slice.call(arguments,1);return this.forEach(function(i){i instanceof Array?i[0][t].apply(i[0],i.slice(1)):i[t].apply(i,e)}),this},Array.prototype.random=function(){for(var t=this.slice(0),e=[],i=t.length;i--;)e.push(t.splice(Ucren.randomNumber(i+1),1)[0]);return e},Ucren={isIe:/msie/i.test(navigator.userAgent),isIe6:/msie 6/i.test(navigator.userAgent),isFirefox:/firefox/i.test(navigator.userAgent),isSafari:/version\/[\d\.]+\s+safari/i.test(navigator.userAgent),isOpera:/opera/i.test(navigator.userAgent),isChrome:/chrome/i.test(navigator.userAgent),isStrict:"CSS1Compat"==document.compatMode,tempDom:document.createElement("div"),apply:function(t,e,i){return e||(e={}),i?Ucren.each(t,function(t,r){r in i||(e[r]=t)}):Ucren.each(t,function(t,i){e[i]=t}),e},appendStyle:function(t){var e;arguments.length>1&&(t=join.call(arguments,"")),document.createStyleSheet?(e=document.createStyleSheet(),e.cssText=t):(e=document.createElement("style"),e.type="text/css",e.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(e))},addEvent:function(t,e,i){var r=function(){i.apply(t,arguments)};return t.dom&&(t=t.dom),window.attachEvent?t.attachEvent("on"+e,r):window.addEventListener?t.addEventListener(e,r,!1):t["on"+e]=r,r},delEvent:function(t,e,i){window.detachEvent?t.detachEvent("on"+e,i):window.removeEventListener?t.removeEventListener(e,i,!1):t["on"+e]==i&&(t["on"+e]=null)},Class:function(t,e,i,r){var n,s,a;return t=t||function(){},e=e||{},a={},n=function(){this.instanceId=Ucren.id(),t.apply(this,arguments)},s=n.prototype,Ucren.registerClassEvent.call(s),Ucren.each(e,function(t,e){s[e]=function(t,e){return"function"==typeof t?function(){var n,s;return n=slice.call(arguments,0),i&&i.apply(this,[e].concat(n))===!1?void 0:(this.fireEvent("before"+e,n),s=t.apply(this,n),r&&r.apply(this,[e].concat(n)),this.fireEvent(e,n),s)}:t}(t,e)}),s.getOriginMethod=function(t){return e[t]},n},registerClassEvent:function(){this.on=function(t,e){var i=this.instanceId;Ucren.dispatch(i+t,e.bind(this))},this.onbefore=function(t,e){var i=this.instanceId;Ucren.dispatch(i+"before"+t,e.bind(this))},this.un=function(){},this.fireEvent=function(t,e){var i=this.instanceId;Ucren.dispatch(i+t,e)}},createFuze:function(){var t,e,i;return t=[],e=function(e){i?e():t.push(e)},e.fire=function(){for(;t.length;)t.shift()();i=!0},e.extinguish=function(){i=!1},e.wettish=function(){t.length&&t.shift()()},e},dispatch:function(){var e,i,r,t={};return e=function(e,i,r){var n;(n=t[e])&&Ucren.each(n,function(t){t.apply(r,i)})},i=function(e,i){var r;(r=t[e])?r.push(i):t[e]=[i]},r=function(t,r){"undefined"==typeof r&&(r=[]),r instanceof Array?e.apply(this,arguments):"function"==typeof r&&i.apply(this,arguments)},r.remove=function(e,i){var r,n;(r=t[e])&&~(n=r.indexOf(i))&&r.splice(n,1)},r}(),each:function(t,e){if(t instanceof Array||"object"==typeof t&&"undefined"!=typeof t[0]&&t.length)"object"==typeof t&&Ucren.isSafari&&(t=slice.call(t)),t.forEach(e);else if("object"==typeof t){var i={};for(var r in t)if(!i[r]&&e(t[r],r)===!1)break}else if("number"==typeof t)for(var r=0;t>r&&e(r,r)!==!1;r++);else if("string"==typeof t)for(var r=0,n=t.length;n>r&&e(t.charAt(r),r)!==!1;r++);},Element:function(t,e){var i,r;
return t&&t.isUcrenElement?e?t.dom:t:(t="string"==typeof t?document.getElementById(t):t)?e?t:(r=t.getAttribute("handleId"),"string"==typeof r?Ucren.handle(r-0):(i=new Ucren.BasicElement(t),r=Ucren.handle(i),t.setAttribute("handleId",r+""),i)):null},Event:function(t){if(t=t||window.event,!t)for(var e=arguments.callee.caller;e&&(t=e.arguments[0],!t||"boolean"!=typeof t.altKey);)e=e.caller,t=null;return t},fixNumber:function(t,e){return"number"==typeof t?t:e},fixString:function(t,e){return"string"==typeof t?t:e},fixConfig:function(t){var e;return e={},"undefined"==typeof t?e:"function"==typeof t?new t:t},handle:function(t){var e,i,r;return e=arguments.callee,e.cache||(e.cache={}),"undefined"==typeof e.number&&(e.number=0),i=typeof t,"number"==i?e.cache[t.toString()]:"object"==i||"function"==i?(r=e.number++,e.cache[r.toString()]=t,r):void 0},id:function(){var t=arguments.callee;return t.number=++t.number||0,"_"+t.number},loadImage:function(t,e){var i=t.length,r=0,n=function(){r==i&&e&&e()};Ucren.each(t,function(t){var e=document.createElement("img");e.onload=e.onerror=function(){this.onload=this.onerror=null,r++,n()},Ucren.tempDom.appendChild(e),e.src=t})},loadScript:function(src,callback){Ucren.request(src,function(text){eval(text),callback&&callback(text)})},makeElement:function(t,e){var i=document.createElement(t),r=function(t){"string"==typeof t?i.style.cssText=t:Ucren.apply(t,i.style)};for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:"style"===n?r(e[n]):i.setAttribute(n,e[n]);return i},nul:function(){return!1},randomNumber:function(t){return Math.floor(Math.random()*t)},randomWord:function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return function(e,i){var r,n=[];return r=i||t,Ucren.each(e,function(t){n[t]=r.charAt(this.randomNumber(r.length))}.bind(this)),n.join("")}}(),request:function(t,e){request=Ucren.request;var i=request.xhr;request.xhr||(i=request.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")),i.open("GET",t,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&e(i.responseText)},i.send(null)}},Ucren.BasicDrag=Ucren.Class(function(t){t=Ucren.fixConfig(t),this.type=Ucren.fixString(t.type,"normal");var e=this.isTouch="ontouchstart"in window;this.TOUCH_START=e?"touchstart":"mousedown",this.TOUCH_MOVE=e?"touchmove":"mousemove",this.TOUCH_END=e?"touchend":"mouseup"},{bind:function(t,e){t=Ucren.Element(t),e=Ucren.Element(e)||t;var i={};i[this.TOUCH_START]=function(t){return t=Ucren.Event(t),this.startDrag(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),t.returnValue=!1}.bind(this),e.addEvents(i),this.target=t},getCoors:function(t){var e=[];if(t.targetTouches&&t.targetTouches.length){var i=t.targetTouches[0];e[0]=i.clientX,e[1]=i.clientY}else e[0]=t.clientX,e[1]=t.clientY;return e},startDrag:function(){var t,e,i;t=this.target,e=t.draging={},this.isDraging=!0,e.x=parseInt(t.style("left"),10)||0,e.y=parseInt(t.style("top"),10)||0,i=Ucren.Event();var r=this.getCoors(i);e.mouseX=r[0],e.mouseY=r[1],this.registerDocumentEvent()},endDrag:function(){this.isDraging=!1,this.unRegisterDocumentEvent()},registerDocumentEvent:function(){var t,e;t=this.target,e=t.draging,e.documentSelectStart=Ucren.addEvent(document,"selectstart",function(t){return t=t||event,t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1}),e.documentMouseMove=Ucren.addEvent(document,this.TOUCH_MOVE,function(t){var i,r;t=t||event,i=Ucren.isIe&&1!=t.button,r=!Ucren.isIe&&0!=t.button,!i&&!r||this.isTouch||this.endDrag();var n=this.getCoors(t);return e.newMouseX=n[0],e.newMouseY=n[1],t.stopPropagation&&t.stopPropagation(),t.returnValue=!1}.bind(this)),e.documentMouseUp=Ucren.addEvent(document,this.TOUCH_END,function(){this.endDrag()}.bind(this));var i,r;clearInterval(e.timer),e.timer=setInterval(function(){var n,s,a,o;e.newMouseX!=i&&e.newMouseY!=r&&(i=e.newMouseX,r=e.newMouseY,a=e.newMouseX-e.mouseX,o=e.newMouseY-e.mouseY,n=e.x+a,s=e.y+o,"calc"==this.type?this.returnValue(a,o,e.newMouseX,e.newMouseY):t.left(n).top(s))}.bind(this),10)},unRegisterDocumentEvent:function(){var t=this.target.draging;Ucren.delEvent(document,this.TOUCH_MOVE,t.documentMouseMove),Ucren.delEvent(document,this.TOUCH_END,t.documentMouseUp),Ucren.delEvent(document,"selectstart",t.documentSelectStart),clearInterval(t.timer)},returnValue:function(){}}),Ucren.Template=Ucren.Class(function(){this.string=join.call(arguments,"")},{apply:function(t){return this.string.format(t)}}),Ucren.BasicElement=Ucren.Class(function(t){this.dom=t,this.countMapping={}},{isUcrenElement:!0,attr:function(t,e){return"string"!=typeof e?this.dom.getAttribute(t):(this.dom.setAttribute(t,e),this)},style:function(){var t=Ucren.isIe?function(t){return this.dom.currentStyle[t]}:function(t){var e;return e=document.defaultView.getComputedStyle(this.dom,null),e.getPropertyValue(t)};return function(e,i){if("object"==typeof e)Ucren.each(e,function(t,e){this[e]=t}.bind(this.dom.style));else{if("string"==typeof e&&"undefined"==typeof i)return t.call(this,e);"string"==typeof e&&"undefined"!=typeof i&&(this.dom.style[e]=i)}return this}}(),hasClass:function(t){var e=" "+this.dom.className+" ";return e.indexOf(" "+t+" ")>-1},setClass:function(t){return"string"==typeof t&&(this.dom.className=t.trim()),this},addClass:function(t){var e,i;return e=this.dom,i=" "+e.className+" ",-1==i.indexOf(" "+t+" ")&&(i+=t,i=i.trim(),i=i.replace(/ +/g," "),e.className=i),this},delClass:function(t){var e,i;return e=this.dom,i=" "+e.className+" ",i.indexOf(" "+t+" ")>-1&&(i=i.replace(" "+t+" "," "),i=i.trim(),i=i.replace(/ +/g," "),e.className=i),this},html:function(t){var e=this.dom;if("string"==typeof t)e.innerHTML=t;else{if(!(t instanceof Array))return e.innerHTML;e.innerHTML=t.join("")}return this},left:function(t){var e=this.dom;return"number"!=typeof t?this.getPos().x:(e.style.left=t+"px",this.fireEvent("infect",[{left:t}]),this)},top:function(t){var e=this.dom;return"number"!=typeof t?this.getPos().y:(e.style.top=t+"px",this.fireEvent("infect",[{top:t}]),this)},width:function(t){var e=this.dom;if("number"==typeof t)e.style.width=t+"px",this.fireEvent("infect",[{width:t}]);else{if("string"!=typeof t)return this.getSize().width;e.style.width=t,this.fireEvent("infect",[{width:t}])}return this},height:function(t){var e=this.dom;if("number"==typeof t)e.style.height=t+"px",this.fireEvent("infect",[{height:t}]);else{if("string"!=typeof t)return this.getSize().height;e.style.height=t,this.fireEvent("infect",[{height:t}])}return this},count:function(t){return this.countMapping[t]=++this.countMapping[t]||1},display:function(t){var e=this.dom;return"boolean"!=typeof t?"none"!=this.style("display"):(e.style.display=t?"block":"none",this.fireEvent("infect",[{display:t}]),this)},first:function(){for(var t=this.dom.firstChild;t&&!t.tagName&&t.nextSibling;)t=t.nextSibling;return t},add:function(t){var e;return e=Ucren.Element(t),this.dom.appendChild(e.dom),this},remove:function(t){var e;return t?(e=Ucren.Element(t),e.html(""),this.dom.removeChild(e.dom)):(e=Ucren.Element(this.dom.parentNode),e.remove(this)),this},insert:function(t){var e;return e=this.dom,e.firstChild?e.insertBefore(t,e.firstChild):this.add(t),this},addEvents:function(t){var e,i,r;return e={},r={},i=this.dom,Ucren.each(t,function(t,e){r[e]=Ucren.addEvent(i,e,t)}),r},removeEvents:function(t){var e,i;return e={},i=this.dom,Ucren.each(t,function(t,e){Ucren.delEvent(i,e,t)}),this},getPos:function(){var t,e,i,r,n;if(t=this.dom,i={},t.getBoundingClientRect){r=t.getBoundingClientRect(),n=Ucren.isIe?2:0;var s=document,a=Math.max(s.documentElement.scrollTop,s.body.scrollTop),o=Math.max(s.documentElement.scrollLeft,s.body.scrollLeft);return{x:r.left+o-n,y:r.top+a-n}}if(i={x:t.offsetLeft,y:t.offsetTop},e=t.offsetParent,e!=t)for(;e;)i.x+=e.offsetLeft,i.y+=e.offsetTop,e=e.offsetParent;for(Ucren.isSafari&&"absolute"==this.style("position")&&(i.x-=document.body.offsetLeft,i.y-=document.body.offsetTop),e=t.parentNode?t.parentNode:null;e&&"BODY"!=e.tagName.toUpperCase()&&"HTML"!=e.tagName.toUpperCase();)i.x-=e.scrollLeft,i.y-=e.scrollTop,e=e.parentNode?e.parentNode:null;return i},getSize:function(){var t=this.dom,e=this.style("display");if(e&&"none"!==e)return{width:t.offsetWidth,height:t.offsetHeight};var i=t.style,r={visibility:i.visibility,position:i.position,display:i.display},n={visibility:"hidden",display:"block"};"fixed"!==r.position&&(n.position="absolute"),this.style(n);var s={width:t.offsetWidth,height:t.offsetHeight};return this.style(r),s},observe:function(t,e){return t=Ucren.Element(t),t.on("infect",e.bind(this)),this},usePNGbackground:function(t){var e;return e=this.dom,/\.png$/i.test(t)&&Ucren.isIe6?e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+t+"',sizingMethod='scale' );":e.style.backgroundImage="url( "+t+" )",this},setAlpha:function(){var t=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/;return function(e){var i=this.dom,r=i.style;return Ucren.isIe?(i.currentStyle&&!i.currentStyle.hasLayout&&(r.zoom=1),t.test(r.filter)?(e=e>=99.99?"":"alpha( opacity="+e+" )",r.filter=r.filter.replace(t,e)):r.filter+=" alpha( opacity="+e+" )"):r.opacity=e/100,this}}(),fadeIn:function(t){"undefined"==typeof this.fadingNumber&&(this.fadingNumber=0),this.setAlpha(this.fadingNumber);var e=function(){this.setAlpha(this.fadingNumber),100==this.fadingNumber?(clearInterval(this.fadingInterval),t&&t()):this.fadingNumber+=10}.bind(this);return this.display(!0),clearInterval(this.fadingInterval),this.fadingInterval=setInterval(e,Ucren.isIe?20:30),this},fadeOut:function(t){"undefined"==typeof this.fadingNumber&&(this.fadingNumber=100),this.setAlpha(this.fadingNumber);var e=function(){this.setAlpha(this.fadingNumber),0==this.fadingNumber?(clearInterval(this.fadingInterval),this.display(!1),t&&t()):this.fadingNumber-=10}.bind(this);return clearInterval(this.fadingInterval),this.fadingInterval=setInterval(e,Ucren.isIe?20:30),this},useMouseAction:function(t,e){return this.MouseAction||(this.MouseAction=new Ucren.MouseAction({element:this})),this.MouseAction.use(t,e),this}}),Ucren.isIe&&document.execCommand("BackgroundImageCache",!1,!0);for(var i in Ucren)exports[i]=Ucren[i];return exports}),define("scripts/object/background.js",function(t){function o(){var t,e;t=a(12)-6,e=a(12)-6,n.attr({x:t,y:e})}var n,s,e=require("scripts/lib/ucren"),i=require("scripts/layer"),r=require("scripts/timeline"),a=e.randomNumber;return t.set=function(){n=i.createImage("default","images/background.jpg",0,0,640,480)},t.wobble=function(){s=r.setInterval(o,50)},t.stop=function(){s.stop(),n.attr({x:0,y:0})},t}),define("scripts/object/console.js",function(t){var e=require("scripts/layer"),i=16,r=0,n=[];return t.set=function(){},t.clear=function(){for(var t=0,e=n.length;e>t;t++)n[t].remove();n.length=r=0},t.log=function(t){r+=20,n.push(e.createText("default",t,i,r))},t}),define("scripts/object/developing.js",function(t){var e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),s=(require("scripts/message"),i.exponential.co);return t.anims=[],t.set=function(){this.image=e.createImage("default","images/developing.png",103,218,429,53).hide().scale(1e-5,1e-5)},t.show=function(t){r.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims}),this.hide(2e3)},t.hide=function(t){r.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.onZoomStart=function(){this.image.show()},t.onZooming=function(t,e,i,r){this.image.scale(r=s(t,e,i-e,500),r)},t.onZoomEnd=function(t,e,i){"hide"===i&&this.image.hide()},t}),define("scripts/object/dojo.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/dojo.png",41,240,175,175,1e-5,i.exponential.co,500)}),define("scripts/object/flame.js",function(t){function l(t,i,r,n,s){return s[h]={id:h++,birthday:new Date,center:t,angle:i,length:r,life:n,path:e.path().attr({stroke:"none",fill:o(180*i/c)+"-#fafad9-#f0ef9c"})}}function p(t,e){var i=t[e];if(i){var r,n,u,h,l,p;if(r=1-(new Date-i.birthday)/i.life,0>=r)return i.path.remove(),void delete t[i.id];var d,m,v;d=i.angle,m=i.center,v=i.length,n=[o(m[0]+s(d)*v*(1-r)),o(m[1]+a(d)*v*(1-r))],u=[o(n[0]-s(d)*f*r),o(n[1]-a(d)*f*r)],h=[o(n[0]+s(d)*f*r),o(n[1]+a(d)*f*r)],l=[o(n[0]-s(d+.5*c)*f*.4*r),o(n[1]-a(d+.5*c)*f*.4*r)],p=[o(n[0]-s(d-.5*c)*f*.4*r),o(n[1]-a(d-.5*c)*f*.4*r)],i.path.attr({path:"M"+u+" Q"+[l,h,p,u].join(" ")})}}function d(t,e){var i=t[e];i&&(i.path.remove(),delete t[e])}var e=require("scripts/layer").getLayer("fruit"),i=require("scripts/timeline"),r=require("scripts/lib/ucren"),n=Math,s=n.cos,a=n.sin,o=parseInt,u=n.random,c=n.PI,h=0,f=15;return t.create=function(t,n,s){var a,o,h={pos:function(t,e){f=t,m=e,v.attr("x",f-21).attr("y",m-21)},remove:function(){[a,o].invoke("stop"),v.remove();for(var t in g)d(g,t)}},f=t,m=n,v=e.image("images/smoke.png",f-21,m-21,43,43).hide(),g={};return a=i.setTimeout(function(){v.show(),o=i.setInterval(function(){u()<.9&&l([f,m],2*c*u(),60,200+500*u(),g);for(var t in g)p(g,t)},r.isIe?20:40)},s||0),h},t}),define("scripts/object/flash.js",function(t){var s,a,e=require("scripts/layer"),i=require("scripts/timeline").use("flash").init(10),r=require("scripts/lib/tween"),n=require("scripts/lib/sound"),o=0,u=0,c=r.quadratic.cio,h=[],l=100;return t.set=function(){s=e.createImage("flash","images/flash.png",0,0,358,20).hide(),a=n.create("sound/splatter")},t.showAt=function(t,e,r){s.rotate(r,!0).scale(1e-5,1e-5).attr({x:t+o,y:e+u}).show(),h.clear&&h.clear(),a.play(),i.createTask({start:0,duration:l,data:[1e-5,1],object:this,onTimeUpdate:this.onTimeUpdate,recycle:h}),i.createTask({start:l,duration:l,data:[1,1e-5],object:this,onTimeUpdate:this.onTimeUpdate,recycle:h})},t.onTimeUpdate=function(t,e,i,r){s.scale(r=c(t,e,i-e,l),r)},t}),define("scripts/object/fps.js",function(t){return t}),define("scripts/object/game-over.js",function(t){var e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),s=(require("scripts/message"),require("scripts/state")),a=i.exponential.co;return t.anims=[],t.set=function(){this.image=e.createImage("default","images/game-over.png",75,198,490,85).hide().scale(1e-5,1e-5)},t.show=function(t){r.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.hide=function(t){r.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.onZoomStart=function(t,e,i){"show"==i&&this.image.show()},t.onZooming=function(t,e,i,r){this.image.scale(r=a(t,e,i-e,500),r)},t.onZoomEnd=function(t,e,i){"show"==i?s("click-enable").on():"hide"===i&&this.image.hide()},t}),define("scripts/object/home-desc.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/home-desc.png",161,91,-161,140,7,127,i.exponential.co,500)}),define("scripts/object/home-mask.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/home-mask.png",640,183,0,-183,0,0,i.exponential.co,1e3)}),define("scripts/object/knife.js",function(t){function p(t){this.sx=t.sx,this.sy=t.sy,this.ex=t.ex,this.ey=t.ey,f.push(this)}var e=require("scripts/timeline"),i=require("scripts/layer").getLayer("knife"),n=(require("scripts/lib/ucren"),null),s=null,a=Math.abs,o=200,u=10,c="#cbd3db",h=[],l=!0,f=[];return p.prototype.set=function(){var t,r,n,s,l,f,p,d;return t=this.sx,r=this.sy,n=this.ex,s=this.ey,l=t-n,f=r-s,p=a(l),d=a(f),p>d?(t+=0>l?-1:1,r+=0>f?-(1*d/p):1*d/p):(t+=0>l?-(1*p/d):1*p/d,r+=0>f?-1:1),this.line=i.path("M"+t+","+r+"L"+n+","+s).attr({stroke:c,"stroke-width":u+"px"}),e.createTask({start:0,duration:o,object:this,onTimeUpdate:this.update,onTimeEnd:this.end,recycle:h}),this},p.prototype.update=function(t){this.line.attr("stroke-width",u*(1-t/o)+"px")},p.prototype.end=function(){this.line.remove();var t;(t=f.indexOf(this))&&f.splice(t,1)},t.newKnife=function(){n=s=null},t.through=function(t,e){if(l){var i=null;return null===n||n==t&&s==e||(new p({sx:n,sy:s,ex:t,ey:e}).set(),i=[n,s,t,e]),n=t,s=e,i}},t.pause=function(){h.clear(),this.switchOff()},t.switchOff=function(){l=!1},t.switchOn=function(){l=!0,this.endAll()},t.endAll=function(){for(var t=f.length-1;t>=0;t--)f[t].end()},t}),define("scripts/object/light.js",function(t){function d(t,i,r){var n,s,l,f,p,d;n=36*r+a(10),s=n+5,n=o*n/180,s=o*s/180,l=t+640*c(n),f=i+640*u(n),p=t+640*c(s),d=i+640*u(s);var m=e.path(["M",t,i,"L",l,f,"L",p,d,"Z"]).attr({stroke:"none",fill:"#fff"});h.push(m)}var e=require("scripts/layer"),i=e.getLayer("mask");e=e.getLayer("light");for(var r=require("scripts/lib/ucren"),n=require("scripts/timeline"),s=require("scripts/message"),a=r.randomNumber,o=Math.PI,u=Math.sin,c=Math.cos,h=[],l=[],f=10,p=0;f>p;p++)l[p]=p;return t.start=function(t){for(var e=t.originX,i=t.originY,r=0,s=l.random(),a=f,o=function(){d(e,i,s[this])};a--;)n.setTimeout(o.bind(a),r+=100);n.setTimeout(function(){this.overWhiteLight()}.bind(this),r+100)},t.overWhiteLight=function(){s.postMessage("overWhiteLight.show"),this.removeLights();var t=4e3,e=i.rect(0,0,640,480).attr({fill:"#fff",stroke:"none"}),r={onTimeUpdate:function(i){e.attr("opacity",1-i/t)},onTimeEnd:function(){e.remove(),s.postMessage("game.over")}};n.createTask({start:0,duration:t,object:r,onTimeUpdate:r.onTimeUpdate,onTimeEnd:r.onTimeEnd})},t.removeLights=function(){for(var t=0,e=h.length;e>t;t++)h[t].remove();h.length=0},t}),define("scripts/object/logo.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/logo.png",288,135,17,-182,17,1,i.exponential.co,1e3)}),define("scripts/object/lose.js",function(t){function v(t){var n=e.createImage("default","images/lose.png",t-27,406,54,50).scale(1e-5,1e-5),s=500,a={show:function(t){r.createTask({start:t,duration:s,data:[i.back.co,1e-5,1],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onShowEnd})},hide:function(t){r.createTask({start:t,duration:s,data:[i.back.ci,1,1e-5],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd})},onScaling:function(t,e,i,r,a){n.scale(a=e(t,i,r-i,s),a)},onShowEnd:function(){this.hide(1500)},onHideEnd:function(){n.remove()}};a.show(200)}var u,c,h,e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),s=(require("scripts/lib/ucren"),require("scripts/message")),a=i.exponential.co,o=i.back.co,l=500,f={src:"images/x.png",sx:650,ex:561,y:5,w:22,h:19},p={src:"images/xx.png",sx:671,ex:582,y:5,w:27,h:26},d={src:"images/xxx.png",sx:697,ex:608,y:6,w:31,h:32},m=0;return t.anims=[],t.set=function(){u=e.createImage("default",f.src,f.sx,f.y,f.w,f.h).hide(),c=e.createImage("default",p.src,p.sx,p.y,p.w,p.h).hide(),h=e.createImage("default",d.src,d.sx,d.y,d.w,d.h).hide()},t.reset=function(){m=0,[[u,f],[c,p],[h,d]].forEach(function(t){t[0].attr("src",t[1].src.replace("xf.png","x.png"))})},t.show=function(t){r.createTask({start:t,duration:l,data:["show",f.sx,f.ex,p.sx,p.ex,d.sx,d.ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.hide=function(t){r.createTask({start:t,duration:l,data:["hide",f.ex,f.sx,p.ex,p.sx,d.ex,d.sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.showLoseAt=function(t){var e,i=[[u,f],[c,p],[h,d]];v(t),e=i[++m-1],e[0].attr("src",e[1].src.replace("x.png","xf.png")).scale(1e-5,1e-5),this.scaleImage(e[0]),3==m&&s.postMessage("game.over")},t.scaleImage=function(t){var e=500;t.myOnScaling=t.myOnScaling||function(t,i){this.scale(i=o(t,1e-5,.99999,e),i)},t.myOnScaleEnd=t.myOnScaleEnd||function(){this.scale(1,1)},r.createTask({start:0,duration:e,object:t,onTimeUpdate:t.myOnScaling,onTimeEnd:t.myOnScaleEnd,recycle:this.anims})},t.onTimeUpdate=function(t,e,i,r,n,s,o,f){u.attr("x",a(t,i,r-i,l)),c.attr("x",a(t,n,s-n,l)),h.attr("x",a(t,o,f-o,l))},t.onTimeStart=function(t){"show"==t&&[u,c,h].invoke("show")},t.onTimeEnd=function(t){"hide"==t&&([u,c,h].invoke("hide"),this.reset())},t}),define("scripts/object/new-game.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/new-game.png",244,231,195,195,1e-5,i.exponential.co,500)}),define("scripts/object/new.js",function(t){var s,e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),a=(require("scripts/lib/ucren"),300),o=129,u=328,c=170,h=221,l=0,f=0,p=70,d=42,m=8,v=i.exponential.co,g=i.quadratic.ci;return t.anims=[],t.set=function(){s=e.createImage("default","images/new.png",o,u,l,f)},t.unset=function(){},t.show=function(t){r.createTask({start:t,duration:500,data:[o,c,u,h,l,p,f,d],object:this,onTimeUpdate:this.onShowing,onTimeStart:this.onShowStart,onTimeEnd:this.onShowEnd,recycle:this.anims})},t.hide=function(t){this.anims.clear(),r.createTask({start:t,duration:500,data:[c,o,h,u,p,l,d,f],object:this,onTimeUpdate:this.onShowing,recycle:this.anims})},t.jump=function(){this.anims.clear(),r.createTask({start:0,duration:-1,object:this,onTimeUpdate:this.onJumping,recycle:this.anims})},t.onShowStart=function(){},t.onShowing=function(t,e,i,r,n,a,o,u,c){s.attr({x:v(t,e,i-e,500),y:v(t,r,n-r,500),width:v(t,a,o-a,500),height:v(t,u,c-u,500)})},t.onShowEnd=function(){this.jump()},t.onJumping=function(t){var e=parseInt(t/a);t%=a,e%2&&(t=a-t),s.attr("y",g(t,h,m,a))},t}),define("scripts/object/ninja.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/ninja.png",244,81,315,-140,315,43,{show:i.bounce.co,hide:i.exponential.co},1e3)}),define("scripts/object/quit.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/quit.png",493,311,141,141,1e-5,i.exponential.co,500)}),define("scripts/object/score.js",function(t){var u,c,h,e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),s=(require("scripts/lib/ucren"),r.setTimeout.bind(r)),a=i.exponential.co,l=(require("scripts/message"),500),f=-94,p=6,d=-59,m=41,v=-93,g=7;return t.anims=[],t.set=function(){u=e.createImage("default","images/score.png",f,8,29,31).hide(),c=e.createText("default","0",d,24,"90-#fc7f0c-#ffec53","30px").hide(),h=e.createText("default","BEST 999",v,48,"#af7c05","14px").hide()},t.show=function(t){r.createTask({start:t,duration:l,data:["show",f,p,d,m,v,g],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.hide=function(t){r.createTask({start:t,duration:l,data:["hide",p,f,m,d,g,v],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.number=function(t){c.attr("text",t||0),u.scale(1.2,1.2),s(function(){u.scale(1,1)},60)},t.onTimeUpdate=function(t,e,i,r,n,s,o,f){u.attr("x",a(t,i,r-i,l)),c.attr("x",a(t,n,s-n,l)),h.attr("x",a(t,o,f-o,l))},t.onTimeStart=function(t){"show"===t&&[u,c,h].invoke("show")},t.onTimeEnd=function(t){"hide"===t&&([u,c,h].invoke("hide"),c.attr("text",0))},t}),startModule("scripts/main");